package
{
	import com.brassmonkey.controls.SlotDisplay;
	
	import flash.display.Loader;
	import flash.display.MovieClip;
	import flash.display.Sprite;
	import flash.events.Event;
	import flash.events.MouseEvent;
	import flash.external.ExternalInterface;
	import flash.net.URLLoader;
	import flash.net.URLRequest;
	import flash.net.navigateToURL;


	[SWF(width="1024" ,height="768")]
	

	public class Main extends Sprite
	{
		public var helper:Connector;
		
		public var slotDisplay:SlotDisplay=new SlotDisplay();

		public function Main()
		{
		
			stage.addEventListener(Event.RESIZE, onResize);
			
			helper=new Connector();
			helper.nodeviceBtn.visible = false;
			helper.phone.visible = false;
			helper._deviceList.visible = false;
			helper._timer.visible = true;			
			helper.nodeviceBtn.visible = false;
			helper.download_ios.addEventListener(MouseEvent.MOUSE_UP, onGetIos);
			helper.download_android.addEventListener(MouseEvent.MOUSE_UP,onGetAndroid);
			helper.nodeviceBtn.addEventListener(MouseEvent.MOUSE_UP,onGetHelp);
			helper.helpBtn.addEventListener(MouseEvent.MOUSE_UP,onGetHelp);
			//https://itunes.apple.com/us/app/brass-monkey/id455013514
			
			ExternalInterface.addCallback("onTick",onTick);
			ExternalInterface.addCallback("setState",setState);
			ExternalInterface.addCallback("setSlot",setSlot);
			ExternalInterface.addCallback("printHelp",printHelp);
			addChild(helper);
		}
		
		protected function onGetIos(event:MouseEvent):void
		{
			flash.net.navigateToURL(new URLRequest("https://itunes.apple.com/us/app/brass-monkey/id455013514"),"_getbrassmonkey");
			
		}
		protected function onGetAndroid(event:MouseEvent):void 
		{
			flash.net.navigateToURL(new URLRequest("https://play.google.com/store/apps/details?id=com.brassmonkey.controller"),"_getbrassmonkey");
			
		}
		protected function onGetHelp(event:MouseEvent):void
		{
			flash.net.navigateToURL(new URLRequest("http://playbrassmonkey.com/support"),"_helpme");
			
		}
		protected function onResize(event:Event):void
		{
		
			
		}
		
		public function printHelp( val:String):void
		{
			helper._info.text=val;
		}
		public function setState( val:String):void
		{
			
			helper.setState(val);
			
		}
		public function setSlot(val:String):void
		{
			
			trace("setSlot"+val);
			slotDisplay.x=360;
			slotDisplay.y=575;
			slotDisplay.slot=parseInt(val);
			if(slotDisplay.slot>0)
			{
				addChild(slotDisplay);
			}
			else
			{
				if(contains(slotDisplay))
					removeChild(slotDisplay);
			}
		}
		public function onTick(val:int):void
		{
			helper.onTick(val);
			helper._timer.visible = true;	
		}
	}
}