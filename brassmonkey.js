function brassmonkeySwfObject(){swfobject=function(){function o(){if(!y){try{var c=g.getElementsByTagName("body")[0].appendChild(g.createElement("span"));c.parentNode.removeChild(c)}catch(k){return}y=true;for(var c=L.length,a=0;a<c;a++)L[a]()}}function E(c){y?c():L[L.length]=c}function F(c){if(typeof q.addEventListener!=m)q.addEventListener("load",c,false);else if(typeof g.addEventListener!=m)g.addEventListener("load",c,false);else if(typeof q.attachEvent!=m)G(q,"onload",c);else if(typeof q.onload==
"function"){var k=q.onload;q.onload=function(){k();c()}}else q.onload=c}function M(){var c=g.getElementsByTagName("body")[0],k=g.createElement(p);k.setAttribute("type",z);var a=c.appendChild(k);if(a){var v=0;(function(){if(typeof a.GetVariable!=m){var i=a.GetVariable("$version");if(i)i=i.split(" ")[1].split(","),f.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}else if(v<10){v++;setTimeout(arguments.callee,10);return}c.removeChild(k);a=null;H()})()}else H()}function H(){var c=s.length;
if(c>0)for(var k=0;k<c;k++){var u=s[k].id,v=s[k].callbackFn,i={success:false,id:u};if(f.pv[0]>0){var b=l(u);if(b)if(a(s[k].swfVersion)&&!(f.wk&&f.wk<312)){if(e(u,true),v)i.success=true,i.ref=I(u),v(i)}else if(s[k].expressInstall&&J()){i={};i.data=s[k].expressInstall;i.width=b.getAttribute("width")||"0";i.height=b.getAttribute("height")||"0";if(b.getAttribute("class"))i.styleclass=b.getAttribute("class");if(b.getAttribute("align"))i.align=b.getAttribute("align");for(var d={},b=b.getElementsByTagName("param"),
g=b.length,p=0;p<g;p++)b[p].getAttribute("name").toLowerCase()!="movie"&&(d[b[p].getAttribute("name")]=b[p].getAttribute("value"));x(i,d,u,v)}else A(b),v&&v(i)}else if(e(u,true),v){if((u=I(u))&&typeof u.SetVariable!=m)i.success=true,i.ref=u;v(i)}}}function I(c){var k=null;if((c=l(c))&&c.nodeName=="OBJECT")typeof c.SetVariable!=m?k=c:(c=c.getElementsByTagName(p)[0])&&(k=c);return k}function J(){return!N&&a("6.0.65")&&(f.win||f.mac)&&!(f.wk&&f.wk<312)}function x(c,k,a,b){N=true;Q=b||null;S={success:false,
id:a};var i=l(a);if(i){i.nodeName=="OBJECT"?(K=C(i),O=null):(K=i,O=a);c.id=T;if(typeof c.width==m||!/%$/.test(c.width)&&parseInt(c.width,10)<310)c.width="310";if(typeof c.height==m||!/%$/.test(c.height)&&parseInt(c.height,10)<137)c.height="137";g.title=g.title.slice(0,47)+" - Flash Player Installation";b=f.ie&&f.win?"ActiveX":"PlugIn";b="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+g.title;typeof k.flashvars!=m?k.flashvars+="&"+b:k.flashvars=
b;if(f.ie&&f.win&&i.readyState!=4)b=g.createElement("div"),a+="SWFObjectNew",b.setAttribute("id",a),i.parentNode.insertBefore(b,i),i.style.display="none",function(){i.readyState==4?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)}();h(c,k,a)}}function A(c){if(f.ie&&f.win&&c.readyState!=4){var k=g.createElement("div");c.parentNode.insertBefore(k,c);k.parentNode.replaceChild(C(c),k);c.style.display="none";(function(){c.readyState==4?c.parentNode.removeChild(c):setTimeout(arguments.callee,
10)})()}else c.parentNode.replaceChild(C(c),c)}function C(c){var k=g.createElement("div");if(f.win&&f.ie)k.innerHTML=c.innerHTML;else if(c=c.getElementsByTagName(p)[0])if(c=c.childNodes)for(var a=c.length,b=0;b<a;b++)!(c[b].nodeType==1&&c[b].nodeName=="PARAM")&&c[b].nodeType!=8&&k.appendChild(c[b].cloneNode(true));return k}function h(c,k,a){var b,i=l(a);if(f.wk&&f.wk<312)return b;if(i){if(typeof c.id==m)c.id=a;if(f.ie&&f.win){var d="",e;for(e in c)if(c[e]!=Object.prototype[e])e.toLowerCase()=="data"?
k.movie=c[e]:e.toLowerCase()=="styleclass"?d+=' class="'+c[e]+'"':e.toLowerCase()!="classid"&&(d+=" "+e+'="'+c[e]+'"');e="";for(var n in k)k[n]!=Object.prototype[n]&&(e+='<param name="'+n+'" value="'+k[n]+'" />');i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+d+">"+e+"</object>";P[P.length]=c.id;b=l(c.id)}else{n=g.createElement(p);n.setAttribute("type",z);for(var h in c)c[h]!=Object.prototype[h]&&(h.toLowerCase()=="styleclass"?n.setAttribute("class",c[h]):h.toLowerCase()!=
"classid"&&n.setAttribute(h,c[h]));for(d in k)k[d]!=Object.prototype[d]&&d.toLowerCase()!="movie"&&(c=n,e=d,h=k[d],a=g.createElement("param"),a.setAttribute("name",e),a.setAttribute("value",h),c.appendChild(a));i.parentNode.replaceChild(n,i);b=n}}return b}function B(c){var a=l(c);if(a&&a.nodeName=="OBJECT")f.ie&&f.win?(a.style.display="none",function(){if(a.readyState==4){var b=l(c);if(b){for(var e in b)typeof b[e]=="function"&&(b[e]=null);b.parentNode.removeChild(b)}}else setTimeout(arguments.callee,
10)}()):a.parentNode.removeChild(a)}function l(c){var a=null;try{a=g.getElementById(c)}catch(b){}return a}function G(c,a,b){c.attachEvent(a,b);D[D.length]=[c,a,b]}function a(c){var a=f.pv,c=c.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return a[0]>c[0]||a[0]==c[0]&&a[1]>c[1]||a[0]==c[0]&&a[1]==c[1]&&a[2]>=c[2]?true:false}function d(c,a,b,e){if(!f.ie||!f.mac){var d=g.getElementsByTagName("head")[0];if(d){b=b&&typeof b=="string"?b:"screen";e&&(R=r=null);if(!r||
R!=b)e=g.createElement("style"),e.setAttribute("type","text/css"),e.setAttribute("media",b),r=d.appendChild(e),f.ie&&f.win&&typeof g.styleSheets!=m&&g.styleSheets.length>0&&(r=g.styleSheets[g.styleSheets.length-1]),R=b;f.ie&&f.win?r&&typeof r.addRule==p&&r.addRule(c,a):r&&typeof g.createTextNode!=m&&r.appendChild(g.createTextNode(c+" {"+a+"}"))}}}function e(c,a){if(U){var b=a?"visible":"hidden";y&&l(c)?l(c).style.visibility=b:d("#"+c,"visibility:"+b)}}function b(c){return/[\\\"<>\.;]/.exec(c)!=null&&
typeof encodeURIComponent!=m?encodeURIComponent(c):c}var m="undefined",p="object",z="application/x-shockwave-flash",T="SWFObjectExprInst",q=window,g=document,t=navigator,V=false,L=[function(){V?M():H()}],s=[],P=[],D=[],K,O,Q,S,y=false,N=false,r,R,U=true,f=function(){var c=typeof g.getElementById!=m&&typeof g.getElementsByTagName!=m&&typeof g.createElement!=m,a=t.userAgent.toLowerCase(),b=t.platform.toLowerCase(),e=b?/win/.test(b):/win/.test(a),b=b?/mac/.test(b):/mac/.test(a),a=/webkit/.test(a)?parseFloat(a.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,
"$1")):false,d=!+"\u000b1",f=[0,0,0],h=null;if(typeof t.plugins!=m&&typeof t.plugins["Shockwave Flash"]==p){if((h=t.plugins["Shockwave Flash"].description)&&!(typeof t.mimeTypes!=m&&t.mimeTypes[z]&&!t.mimeTypes[z].enabledPlugin))V=true,d=false,h=h.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(h.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(h.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(h)?parseInt(h.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof q.ActiveXObject!=m)try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
if(n&&(h=n.GetVariable("$version")))d=true,h=h.split(" ")[1].split(","),f=[parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10)]}catch(l){}return{w3:c,pv:f,wk:a,ie:d,win:e,mac:b}}();(function(){f.w3&&((typeof g.readyState!=m&&g.readyState=="complete"||typeof g.readyState==m&&(g.getElementsByTagName("body")[0]||g.body))&&o(),y||(typeof g.addEventListener!=m&&g.addEventListener("DOMContentLoaded",o,false),f.ie&&f.win&&(g.attachEvent("onreadystatechange",function(){g.readyState=="complete"&&(g.detachEvent("onreadystatechange",
arguments.callee),o())}),q==top&&function(){if(!y){try{g.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}o()}}()),f.wk&&function(){y||(/loaded|complete/.test(g.readyState)?o():setTimeout(arguments.callee,0))}(),F(o)))})();(function(){f.ie&&f.win&&window.attachEvent("onunload",function(){for(var a=D.length,b=0;b<a;b++)D[b][0].detachEvent(D[b][1],D[b][2]);a=P.length;for(b=0;b<a;b++)B(P[b]);for(var e in f)f[e]=null;f=null;for(var d in swfobject)swfobject[d]=null;swfobject=
null})})();return{registerObject:function(a,b,d,g){if(f.w3&&a&&b){var i={};i.id=a;i.swfVersion=b;i.expressInstall=d;i.callbackFn=g;s[s.length]=i;e(a,false)}else g&&g({success:false,id:a})},getObjectById:function(a){if(f.w3)return I(a)},embedSWF:function(c,b,d,g,i,z,l,n,q,r){var o={success:false,id:b};f.w3&&!(f.wk&&f.wk<312)&&c&&b&&d&&g&&i?(e(b,false),E(function(){d+="";g+="";var f={};if(q&&typeof q===p)for(var w in q)f[w]=q[w];f.data=c;f.width=d;f.height=g;w={};if(n&&typeof n===p)for(var s in n)w[s]=
n[s];if(l&&typeof l===p)for(var t in l)typeof w.flashvars!=m?w.flashvars+="&"+t+"="+l[t]:w.flashvars=t+"="+l[t];if(a(i))s=h(f,w,b),f.id==b&&e(b,true),o.success=true,o.ref=s;else if(z&&J()){f.data=z;x(f,w,b,r);return}else e(b,true);r&&r(o)})):r&&r(o)},switchOffAutoHideShow:function(){U=false},ua:f,getFlashPlayerVersion:function(){return{major:f.pv[0],minor:f.pv[1],release:f.pv[2]}},hasFlashPlayerVersion:a,createSWF:function(a,b,d){if(f.w3)return h(a,b,d)},showExpressInstall:function(a,b,d,e){f.w3&&
J()&&x(a,b,d,e)},removeSWF:function(a){f.w3&&B(a)},createCSS:function(a,b,e,g){f.w3&&d(a,b,e,g)},addDomLoadEvent:E,addLoadEvent:F,getQueryParamValue:function(a){var d=g.location.search||g.location.hash;if(d){/\?/.test(d)&&(d=d.split("?")[1]);if(a==null)return b(d);for(var d=d.split("&"),e=0;e<d.length;e++)if(d[e].substring(0,d[e].indexOf("="))==a)return b(d[e].substring(d[e].indexOf("=")+1))}return""},expressInstallCallback:function(){if(N){var a=l(T);if(a&&K){a.parentNode.replaceChild(K,a);if(O&&
(e(O,true),f.ie&&f.win))K.style.display="block";Q&&Q(S)}N=false}}}}()};(function(){function o(a,d){var e=[];bm["on"+a]=function(a){e.push(a)};bm["on"+a+"Internal"]=function(){if(d){bm.log("on"+a+"(");for(var b=0;b<arguments.length;b++)bm.log("    "+JSON.stringify(arguments[b]));bm.log(")")}if(a=="NavigationString")if((arguments[1]=="left"||arguments[1]=="right"||arguments[1]=="up"||arguments[1]=="down"||arguments[1]=="back"||arguments[1]=="activate")&&!C){for(var h=arguments[1],b=0;b<e.length;b++){arguments[1]=h+"Down";try{e[b].apply(bm,arguments)}catch(p){console.log("UnhandledException ("+
p+") in "+bmHooks[j]+" Callback")}arguments[1]=h+"Clicked";try{e[b].apply(bm,arguments)}catch(l){console.log("UnhandledException ("+l+") in "+bmHooks[j]+" Callback")}}arguments[1]=h+"Up"}else C=true;for(b=0;b<e.length;b++)try{e[b].apply(bm,arguments)}catch(o){console.log("UnhandledException ("+o+") in "+bmHooks[j]+" Callback")}}}function E(){function a(a){var b=document.createElement("div");b.id="brassmonkey-swf-wrapper";document.body.appendChild(b);b=bm.options.name;a=typeof bm.options.design=="string"?
bm.options.design:encodeURIComponent(H(bm.options.design,a));a={bmDeviceName:b,wmode:"transparent",debug:"true",bmControllerXML:a};window.parent.passingObj!==void 0&&window.parent.passingObj.appId!==void 0&&window.parent.passingObj.portalId!==void 0?(a.bmDeviceId=window.parent.passingObj.appId,a.bmPortalId=window.parent.passingObj.portalId):a.bmDeviceId=Math.floor(Math.random()*281474943156225).toString(16);bm.deviceId=a.bmDeviceId;swfobject.embedSWF(bm.options.swfURL,"brassmonkey-swf-wrapper","1",
"1","9.0.124","",a,{quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",allowfullscreen:"true"},{id:"brassmonkey",name:"Play Brass Monkey",align:"middle",style:"float:left;z-index:-1;position:absolute;margin-top:-1px;"},function(a){a.success===false&&(play.detectiOS()||$(".flash-required").fadeIn())})}if(typeof bm.options.design=="string")a([]);else if(bm.options.design.images.length==0)a([]);else if(I()==-1)for(var d=0,e=Array(bm.options.design.images.length),b=0;b<bm.options.design.images.length;b++)(function(){var h=
b,l=new Image;l.onload=function(){var b;b=document.createElement("canvas");var o=b.getContext("2d");b.width=l.width;b.height=l.height;o.drawImage(l,0,0);b=b.toDataURL().replace("data:image/png;base64,","");e[h]=b;d++;d==bm.options.design.images.length&&a(e)};l.src=bm.options.design.images[b]})()}function F(a){a/=bm.options.design.orientation=="portrait"?320:480;return a}function M(a){a/=bm.options.design.orientation=="portrait"?480:320;return a}function H(a,d){var e='<?xml version="1.0" encoding="utf-8"?>\n<BMApplicationScheme version="0.1" orientation="'+
a.orientation+'" touchEnabled="'+(a.touchEnabled?"yes":"no")+'" accelerometerEnabled="'+(a.accelerometerEnabled?"yes":"no")+'">\n';if(d.length!=0){e+="<Resources>\n";for(var b=0;b<d.length;b++)e+='<Resource id="'+(b+1)+'" type="image">\n',e+="<data><![CDATA["+d[b]+"]]\></data>\n",e+="</Resource>\n";e+="</Resources>\n"}else e+="<Resources/>\n";if(a.layout.length!=0){e+="<Layout>\n";for(b=0;b<a.layout.length;b++){var h=a.layout[b].handler;a.layout[b].type=="image"&&(h="nullHandler");e+='<DisplayObject type="'+
a.layout[b].type+'" top="'+M(a.layout[b].y)+'" left="'+F(a.layout[b].x)+'" width="'+F(a.layout[b].width)+'" height="'+M(a.layout[b].height)+'" functionHandler="'+h+'">\n';a.layout[b].type=="image"?e+='<Asset name="up" resourceRef="'+(a.layout[b].image+1)+'" />\n':(e+='<Asset name="up" resourceRef="'+(a.layout[b].imageUp+1)+'" />\n',e+='<Asset name="down" resourceRef="'+(a.layout[b].imageDown+1)+'" />\n');e+="</DisplayObject>\n"}e+="</Layout>\n"}else e+="<Layout/>\n";e+="</BMApplicationScheme>";return e}
function I(){var a=-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=null&&(a=parseFloat(RegExp.$1));return a}bm={version:"0.1.0"};window.swfobject===void 0&&brassmonkeySwfObject();bm.init=function(a){bm.options=a;bm.options.logging=a.logging?a.logging:false;bm.options.swfURL=a.swfURL?a.swfURL:"http://s3.amazonaws.com/files.playbrassmonkey.com/sdks/js/v"+bm.version.replace(/\./g,"-")+"/brassmonkey.swf";bm.options.design.images=a.design.images?
a.design.images:[];bm.options.design.layout=a.design.layout?a.design.layout:[]};for(var J="#ff6600,#ffcc00,#ff3399,#ff0066,#cc00ff,#999900,#9999cc,#00cc99,#287200,#00ccff,#003366,#99ff00,#cc0000,#80cd68,#6600ff".split(","),x="DeviceAvailable,DeviceConnected,DeviceDisconnected,NavigationString,KeyString,Invocation,ShakeReceived,AccelReceived,Log,ShowSlot".split(","),A=0;A<x.length;A++)o(x[A],x[A]!="AccelReceived"&&x[A]!="Log");bm.log=function(a){if(bm.options.logging)bm.onLogInternal(a)};var C=false;
bm.showSlotInternal=function(a){bm.onShowSlotInternal(J[a-1])};var h=[];bm.getControllerSlot=function(a){for(var d=0;d<h.length;d++)if(h[d]==a)return d};bm.getControllerCount=function(){for(var a=0,d=0;d<h.length;d++)h[d]!==void 0&&a++;return a};bm.getControllers=function(){for(var a=[],d=0;d<h.length;d++)h[d]!==void 0&&a.push(h[d]);return a};var B={};bm.getDeviceName=function(a){return B[a]};var l={};bm.onDeviceConnected(function(a){B[a.deviceId]=a.deviceName;for(var d=0;d<h.length;d++)if(h[d]===
void 0){h[d]=a.deviceId;return}h.push(a.deviceId);l[a.deviceId]=setInterval(function(){bm.setGamepadMode();console.log("hi")},16)});bm.onDeviceDisconnected(function(a){delete B[a.deviceId];for(var d=0;d<h.length;d++)if(h[d]==a.deviceId){h[d]=void 0;break}bm.getControllerCount();clearInterval(l[a.deviceId]);l[a.deviceId]=void 0});bm.isDeviceConnected=function(a){return B[a.deviceId]==void 0?false:true};var G=[];bm.onTouchesReceived=function(a){G.push(a)};bm.onTouchesReceivedInternal=function(a){for(var d=
0;d<a.touches.length;d++)for(var e=a.touches[d],b=0;b<G.length;b++)G[b](e,a.deviceId)};bm.onSocketReady=function(){};bm.setNavMode=function(){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetNavMode!==void 0&&document.getElementById("brassmonkey").SetNavMode()};bm.setKeyboardMode=function(){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetKeyboardMode!==void 0&&document.getElementById("brassmonkey").SetKeyboardMode()};bm.setGamepadMode=
function(){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetGamepadMode!==void 0&&document.getElementById("brassmonkey").SetGamepadMode()};bm.setVisibility=function(a){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetVisibility!==void 0&&document.getElementById("brassmonkey").SetVisibility(a,true)};bm.enableAccelerometer=function(a,d,e){setTimeout(function(){document.getElementById("brassmonkey").EnableAccelerometer(a,d,e)},2E3)};bm.enableTouch=
function(a,d,e){setTimeout(function(){document.getElementById("brassmonkey").EnableTouch(a,d,e)},2E3)};bm.getWidth=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.width!==void 0?window.parent.passingObj.width:-1};bm.getHeight=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.height!==void 0?window.parent.passingObj.height:-1};bm.getFullscreen=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.fullScreen!==void 0?
window.parent.passingObj.fullScreen:false};window.addEventListener?window.addEventListener("DOMContentLoaded",E,false):window.attachEvent("onload",E)})();
