function brassmonkeySwfObject(){swfobject=function(){function r(){if(!z){try{var c=g.getElementsByTagName("body")[0].appendChild(g.createElement("span"));c.parentNode.removeChild(c)}catch(i){return}z=true;for(var c=K.length,x=0;x<c;x++)K[x]()}}function E(c){z?c():K[K.length]=c}function F(c){if(typeof q.addEventListener!=l)q.addEventListener("load",c,false);else if(typeof g.addEventListener!=l)g.addEventListener("load",c,false);else if(typeof q.attachEvent!=l)a(q,"onload",c);else if(typeof q.onload==
"function"){var i=q.onload;q.onload=function(){i();c()}}else q.onload=c}function L(){var c=g.getElementsByTagName("body")[0],i=g.createElement(p);i.setAttribute("type",v);var x=c.appendChild(i);if(x){var a=0;(function(){if(typeof x.GetVariable!=l){var h=x.GetVariable("$version");if(h)h=h.split(" ")[1].split(","),f.pv=[parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10)]}else if(a<10){a++;setTimeout(arguments.callee,10);return}c.removeChild(i);x=null;G()})()}else G()}function G(){var c=t.length;
if(c>0)for(var i=0;i<c;i++){var a=t[i].id,k=t[i].callbackFn,h={success:false,id:a};if(f.pv[0]>0){var g=n(a);if(g)if(b(t[i].swfVersion)&&!(f.wk&&f.wk<312)){if(e(a,true),k)h.success=true,h.ref=H(a),k(h)}else if(t[i].expressInstall&&I()){h={};h.data=t[i].expressInstall;h.width=g.getAttribute("width")||"0";h.height=g.getAttribute("height")||"0";if(g.getAttribute("class"))h.styleclass=g.getAttribute("class");if(g.getAttribute("align"))h.align=g.getAttribute("align");for(var R={},g=g.getElementsByTagName("param"),
d=g.length,p=0;p<d;p++)g[p].getAttribute("name").toLowerCase()!="movie"&&(R[g[p].getAttribute("name")]=g[p].getAttribute("value"));y(h,R,a,k)}else A(g),k&&k(h)}else if(e(a,true),k){if((a=H(a))&&typeof a.SetVariable!=l)h.success=true,h.ref=a;k(h)}}}function H(c){var i=null;if((c=n(c))&&c.nodeName=="OBJECT")typeof c.SetVariable!=l?i=c:(c=c.getElementsByTagName(p)[0])&&(i=c);return i}function I(){return!M&&b("6.0.65")&&(f.win||f.mac)&&!(f.wk&&f.wk<312)}function y(c,i,a,k){M=true;P=k||null;S={success:false,
id:a};var h=n(a);if(h){h.nodeName=="OBJECT"?(J=C(h),N=null):(J=h,N=a);c.id=T;if(typeof c.width==l||!/%$/.test(c.width)&&parseInt(c.width,10)<310)c.width="310";if(typeof c.height==l||!/%$/.test(c.height)&&parseInt(c.height,10)<137)c.height="137";g.title=g.title.slice(0,47)+" - Flash Player Installation";k=f.ie&&f.win?"ActiveX":"PlugIn";k="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+k+"&MMdoctitle="+g.title;typeof i.flashvars!=l?i.flashvars+="&"+k:i.flashvars=
k;if(f.ie&&f.win&&h.readyState!=4)k=g.createElement("div"),a+="SWFObjectNew",k.setAttribute("id",a),h.parentNode.insertBefore(k,h),h.style.display="none",function(){h.readyState==4?h.parentNode.removeChild(h):setTimeout(arguments.callee,10)}();o(c,i,a)}}function A(c){if(f.ie&&f.win&&c.readyState!=4){var i=g.createElement("div");c.parentNode.insertBefore(i,c);i.parentNode.replaceChild(C(c),i);c.style.display="none";(function(){c.readyState==4?c.parentNode.removeChild(c):setTimeout(arguments.callee,
10)})()}else c.parentNode.replaceChild(C(c),c)}function C(c){var i=g.createElement("div");if(f.win&&f.ie)i.innerHTML=c.innerHTML;else if(c=c.getElementsByTagName(p)[0])if(c=c.childNodes)for(var a=c.length,k=0;k<a;k++)!(c[k].nodeType==1&&c[k].nodeName=="PARAM")&&c[k].nodeType!=8&&i.appendChild(c[k].cloneNode(true));return i}function o(c,i,a){var k,h=n(a);if(f.wk&&f.wk<312)return k;if(h){if(typeof c.id==l)c.id=a;if(f.ie&&f.win){var e="",b;for(b in c)if(c[b]!=Object.prototype[b])b.toLowerCase()=="data"?
i.movie=c[b]:b.toLowerCase()=="styleclass"?e+=' class="'+c[b]+'"':b.toLowerCase()!="classid"&&(e+=" "+b+'="'+c[b]+'"');b="";for(var d in i)i[d]!=Object.prototype[d]&&(b+='<param name="'+d+'" value="'+i[d]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+e+">"+b+"</object>";O[O.length]=c.id;k=n(c.id)}else{d=g.createElement(p);d.setAttribute("type",v);for(var m in c)c[m]!=Object.prototype[m]&&(m.toLowerCase()=="styleclass"?d.setAttribute("class",c[m]):m.toLowerCase()!=
"classid"&&d.setAttribute(m,c[m]));for(e in i)i[e]!=Object.prototype[e]&&e.toLowerCase()!="movie"&&(c=d,b=e,m=i[e],a=g.createElement("param"),a.setAttribute("name",b),a.setAttribute("value",m),c.appendChild(a));h.parentNode.replaceChild(d,h);k=d}}return k}function B(c){var a=n(c);if(a&&a.nodeName=="OBJECT")f.ie&&f.win?(a.style.display="none",function(){if(a.readyState==4){var b=n(c);if(b){for(var e in b)typeof b[e]=="function"&&(b[e]=null);b.parentNode.removeChild(b)}}else setTimeout(arguments.callee,
10)}()):a.parentNode.removeChild(a)}function n(c){var a=null;try{a=g.getElementById(c)}catch(b){}return a}function a(c,a,b){c.attachEvent(a,b);D[D.length]=[c,a,b]}function b(c){var a=f.pv,c=c.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return a[0]>c[0]||a[0]==c[0]&&a[1]>c[1]||a[0]==c[0]&&a[1]==c[1]&&a[2]>=c[2]?true:false}function d(c,a,b,e){if(!f.ie||!f.mac){var h=g.getElementsByTagName("head")[0];if(h){b=b&&typeof b=="string"?b:"screen";e&&(Q=s=null);if(!s||
Q!=b)e=g.createElement("style"),e.setAttribute("type","text/css"),e.setAttribute("media",b),s=h.appendChild(e),f.ie&&f.win&&typeof g.styleSheets!=l&&g.styleSheets.length>0&&(s=g.styleSheets[g.styleSheets.length-1]),Q=b;f.ie&&f.win?s&&typeof s.addRule==p&&s.addRule(c,a):s&&typeof g.createTextNode!=l&&s.appendChild(g.createTextNode(c+" {"+a+"}"))}}}function e(c,a){if(U){var b=a?"visible":"hidden";z&&n(c)?n(c).style.visibility=b:d("#"+c,"visibility:"+b)}}function m(c){return/[\\\"<>\.;]/.exec(c)!=null&&
typeof encodeURIComponent!=l?encodeURIComponent(c):c}var l="undefined",p="object",v="application/x-shockwave-flash",T="SWFObjectExprInst",q=window,g=document,u=navigator,V=false,K=[function(){V?L():G()}],t=[],O=[],D=[],J,N,P,S,z=false,M=false,s,Q,U=true,f=function(){var c=typeof g.getElementById!=l&&typeof g.getElementsByTagName!=l&&typeof g.createElement!=l,a=u.userAgent.toLowerCase(),b=u.platform.toLowerCase(),e=b?/win/.test(b):/win/.test(a),b=b?/mac/.test(b):/mac/.test(a),a=/webkit/.test(a)?parseFloat(a.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,
"$1")):false,h=!+"\u000b1",f=[0,0,0],d=null;if(typeof u.plugins!=l&&typeof u.plugins["Shockwave Flash"]==p){if((d=u.plugins["Shockwave Flash"].description)&&!(typeof u.mimeTypes!=l&&u.mimeTypes[v]&&!u.mimeTypes[v].enabledPlugin))V=true,h=false,d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof q.ActiveXObject!=l)try{var m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
if(m&&(d=m.GetVariable("$version")))h=true,d=d.split(" ")[1].split(","),f=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}catch(o){}return{w3:c,pv:f,wk:a,ie:h,win:e,mac:b}}();(function(){f.w3&&((typeof g.readyState!=l&&g.readyState=="complete"||typeof g.readyState==l&&(g.getElementsByTagName("body")[0]||g.body))&&r(),z||(typeof g.addEventListener!=l&&g.addEventListener("DOMContentLoaded",r,false),f.ie&&f.win&&(g.attachEvent("onreadystatechange",function(){g.readyState=="complete"&&(g.detachEvent("onreadystatechange",
arguments.callee),r())}),q==top&&function(){if(!z){try{g.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}r()}}()),f.wk&&function(){z||(/loaded|complete/.test(g.readyState)?r():setTimeout(arguments.callee,0))}(),F(r)))})();(function(){f.ie&&f.win&&window.attachEvent("onunload",function(){for(var a=D.length,b=0;b<a;b++)D[b][0].detachEvent(D[b][1],D[b][2]);a=O.length;for(b=0;b<a;b++)B(O[b]);for(var e in f)f[e]=null;f=null;for(var d in swfobject)swfobject[d]=null;swfobject=
null})})();return{registerObject:function(a,b,d,g){if(f.w3&&a&&b){var h={};h.id=a;h.swfVersion=b;h.expressInstall=d;h.callbackFn=g;t[t.length]=h;e(a,false)}else g&&g({success:false,id:a})},getObjectById:function(a){if(f.w3)return H(a)},embedSWF:function(a,d,g,k,h,m,n,q,s,r){var v={success:false,id:d};f.w3&&!(f.wk&&f.wk<312)&&a&&d&&g&&k&&h?(e(d,false),E(function(){g+="";k+="";var f={};if(s&&typeof s===p)for(var w in s)f[w]=s[w];f.data=a;f.width=g;f.height=k;w={};if(q&&typeof q===p)for(var t in q)w[t]=
q[t];if(n&&typeof n===p)for(var u in n)typeof w.flashvars!=l?w.flashvars+="&"+u+"="+n[u]:w.flashvars=u+"="+n[u];if(b(h))t=o(f,w,d),f.id==d&&e(d,true),v.success=true,v.ref=t;else if(m&&I()){f.data=m;y(f,w,d,r);return}else e(d,true);r&&r(v)})):r&&r(v)},switchOffAutoHideShow:function(){U=false},ua:f,getFlashPlayerVersion:function(){return{major:f.pv[0],minor:f.pv[1],release:f.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(a,b,d){if(f.w3)return o(a,b,d)},showExpressInstall:function(a,b,d,e){f.w3&&
I()&&y(a,b,d,e)},removeSWF:function(a){f.w3&&B(a)},createCSS:function(a,b,e,g){f.w3&&d(a,b,e,g)},addDomLoadEvent:E,addLoadEvent:F,getQueryParamValue:function(a){var b=g.location.search||g.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return m(b);for(var b=b.split("&"),d=0;d<b.length;d++)if(b[d].substring(0,b[d].indexOf("="))==a)return m(b[d].substring(b[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(M){var a=n(T);if(a&&J){a.parentNode.replaceChild(J,a);if(N&&
(e(N,true),f.ie&&f.win))J.style.display="block";P&&P(S)}M=false}}}}()};(function(){function r(a,b){var d=[];bm["on"+a]=function(a){d.push(a)};bm["on"+a+"Internal"]=function(){if(b){bm.log("on"+a+"(");for(var e=0;e<arguments.length;e++)bm.log("    "+JSON.stringify(arguments[e]));bm.log(")")}if(a=="NavigationString")if((arguments[1]=="left"||arguments[1]=="right"||arguments[1]=="up"||arguments[1]=="down"||arguments[1]=="back"||arguments[1]=="activate")&&!C){for(var m=arguments[1],e=0;e<d.length;e++){arguments[1]=m+"Down";try{d[e].apply(bm,arguments)}catch(l){console.log("UnhandledException ("+
l+") in "+bmHooks[j]+" Callback")}arguments[1]=m+"Clicked";try{d[e].apply(bm,arguments)}catch(p){console.log("UnhandledException ("+p+") in "+bmHooks[j]+" Callback")}}arguments[1]=m+"Up"}else C=true;for(e=0;e<d.length;e++)try{d[e].apply(bm,arguments)}catch(n){console.log("UnhandledException ("+n+") in "+bmHooks[j]+" Callback")}}}function E(){function a(a){var b=document.createElement("div");b.id="brassmonkey-swf-wrapper";document.body.appendChild(b);b=bm.options.name;a=typeof bm.options.design=="string"?
bm.options.design:encodeURIComponent(G(bm.options.design,a));a={bmDeviceName:b,wmode:"transparent",debug:"true",bmControllerXML:a};window.parent.passingObj!==void 0&&window.parent.passingObj.appId!==void 0&&window.parent.passingObj.portalId!==void 0?(a.bmDeviceId=window.parent.passingObj.appId,a.bmPortalId=window.parent.passingObj.portalId):a.bmDeviceId=Math.floor(Math.random()*281474943156225).toString(16);bm.deviceId=a.bmDeviceId;swfobject.embedSWF(bm.options.swfURL,"brassmonkey-swf-wrapper","1",
"1","9.0.124","",a,{quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",allowfullscreen:"true"},{id:"brassmonkey",name:"Play Brass Monkey",align:"middle",style:"float:left;z-index:-1;position:absolute;margin-top:-1px;"},function(a){a.success===false&&(play.detectiOS()||$(".flash-required").fadeIn())})}if(typeof bm.options.design=="string")a([]);else if(bm.options.design.images.length==0)a([]);else if(H()==-1)for(var b=0,d=Array(bm.options.design.images.length),e=0;e<bm.options.design.images.length;e++)(function(){var m=
e,l=new Image;l.onload=function(){var e;e=document.createElement("canvas");var n=e.getContext("2d");e.width=l.width;e.height=l.height;n.drawImage(l,0,0);e=e.toDataURL().replace("data:image/png;base64,","");d[m]=e;b++;b==bm.options.design.images.length&&a(d)};l.src=bm.options.design.images[e]})()}function F(a){a/=bm.options.design.orientation=="portrait"?320:480;return a}function L(a){a/=bm.options.design.orientation=="portrait"?480:320;return a}function G(a,b){var d='<?xml version="1.0" encoding="utf-8"?>\n<BMApplicationScheme version="0.1" orientation="'+
a.orientation+'" touchEnabled="'+(a.touchEnabled?"yes":"no")+'" accelerometerEnabled="'+(a.accelerometerEnabled?"yes":"no")+'">\n';if(b.length!=0){d+="<Resources>\n";for(var e=0;e<b.length;e++)d+='<Resource id="'+(e+1)+'" type="image">\n',d+="<data><![CDATA["+b[e]+"]]\></data>\n",d+="</Resource>\n";d+="</Resources>\n"}else d+="<Resources/>\n";if(a.layout.length!=0){d+="<Layout>\n";for(e=0;e<a.layout.length;e++){var m=a.layout[e].handler;a.layout[e].type=="image"&&(m="nullHandler");d+='<DisplayObject type="'+
a.layout[e].type+'" top="'+L(a.layout[e].y)+'" left="'+F(a.layout[e].x)+'" width="'+F(a.layout[e].width)+'" height="'+L(a.layout[e].height)+'" functionHandler="'+m+'">\n';a.layout[e].type=="image"?d+='<Asset name="up" resourceRef="'+(a.layout[e].image+1)+'" />\n':(d+='<Asset name="up" resourceRef="'+(a.layout[e].imageUp+1)+'" />\n',d+='<Asset name="down" resourceRef="'+(a.layout[e].imageDown+1)+'" />\n');d+="</DisplayObject>\n"}d+="</Layout>\n"}else d+="<Layout/>\n";d+="</BMApplicationScheme>";return d}
function H(){var a=-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=null&&(a=parseFloat(RegExp.$1));return a}bm={version:"0.1.0"};window.swfobject===void 0&&brassmonkeySwfObject();bm.init=function(a){bm.options=a;bm.options.logging=a.logging?a.logging:false;bm.options.swfURL=a.swfURL?a.swfURL:"http://s3.amazonaws.com/files.playbrassmonkey.com/sdks/js/v"+bm.version.replace(/\./g,"-")+"/brassmonkey.swf";bm.options.design.images=a.design.images?
a.design.images:[];bm.options.design.layout=a.design.layout?a.design.layout:[]};for(var I="#ff6600,#ffcc00,#ff3399,#ff0066,#cc00ff,#999900,#9999cc,#00cc99,#287200,#00ccff,#003366,#99ff00,#cc0000,#80cd68,#6600ff".split(","),y="DeviceAvailable,DeviceConnected,DeviceDisconnected,NavigationString,KeyString,Invocation,ShakeReceived,AccelReceived,Log,ShowSlot".split(","),A=0;A<y.length;A++)r(y[A],y[A]!="AccelReceived"&&y[A]!="Log");bm.log=function(a){if(bm.options.logging)bm.onLogInternal(a)};var C=false;
bm.showSlotInternal=function(a){bm.onShowSlotInternal(I[a-1])};var o=[];bm.getControllerSlot=function(a){for(var b=0;b<o.length;b++)if(o[b]==a)return b};bm.getControllerCount=function(){for(var a=0,b=0;b<o.length;b++)o[b]!==void 0&&a++;return a};bm.getControllers=function(){for(var a=[],b=0;b<o.length;b++)o[b]!==void 0&&a.push(o[b]);return a};var B={};bm.getDeviceName=function(a){return B[a]};bm.onDeviceConnected(function(a){B[a.deviceId]=a.deviceName;for(var b=0;b<o.length;b++)if(o[b]===void 0){o[b]=
a.deviceId;return}o.push(a.deviceId)});bm.onDeviceDisconnected(function(a){delete B[a.deviceId];for(var b=0;b<o.length;b++)if(o[b]==a.deviceId){o[b]=void 0;break}bm.getControllerCount()});bm.isDeviceConnected=function(a){return B[a.deviceId]==void 0?false:true};var n=[];bm.onTouchesReceived=function(a){n.push(a)};bm.onTouchesReceivedInternal=function(a){for(var b=0;b<a.touches.length;b++)for(var d=a.touches[b],e=0;e<n.length;e++)n[e](d,a.deviceId)};bm.onSocketReady=function(){};bm.setNavMode=function(){document.getElementById("brassmonkey")&&
document.getElementById("brassmonkey").SetNavMode!==void 0&&document.getElementById("brassmonkey").SetNavMode()};bm.setKeyboardMode=function(){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetKeyboardMode!==void 0&&document.getElementById("brassmonkey").SetKeyboardMode()};bm.setGamepadMode=function(){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetGamepadMode!==void 0&&document.getElementById("brassmonkey").SetGamepadMode()};bm.setVisibility=
function(a){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetVisibility!==void 0&&document.getElementById("brassmonkey").SetVisibility(a,true)};bm.enableAccelerometer=function(a,b,d){setTimeout(function(){document.getElementById("brassmonkey").EnableAccelerometer(a,b,d)},2E3)};bm.enableTouch=function(a,b,d){setTimeout(function(){document.getElementById("brassmonkey").EnableTouch(a,b,d)},2E3)};bm.getWidth=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.width!==
void 0?window.parent.passingObj.width:-1};bm.getHeight=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.height!==void 0?window.parent.passingObj.height:-1};bm.getFullscreen=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.fullScreen!==void 0?window.parent.passingObj.fullScreen:false};window.addEventListener?window.addEventListener("DOMContentLoaded",E,false):window.attachEvent("onload",E)})();
