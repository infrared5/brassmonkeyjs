function brassmonkeySwfObject(){swfobject=function(){function s(){if(!A){try{var d=f.getElementsByTagName("body")[0].appendChild(f.createElement("span"));d.parentNode.removeChild(d)}catch(m){return}A=true;for(var d=K.length,a=0;a<d;a++)K[a]()}}function F(d){A?d():K[K.length]=d}function G(d){if(typeof q.addEventListener!=l)q.addEventListener("load",d,false);else if(typeof f.addEventListener!=l)f.addEventListener("load",d,false);else if(typeof q.attachEvent!=l)a(q,"onload",d);else if(typeof q.onload==
"function"){var m=q.onload;q.onload=function(){m();d()}}else q.onload=d}function L(){var d=document.body,m=f.createElement(t),a=d.appendChild(m);m.setAttribute("type",w);if(a){var k=0;(function(){if(typeof a.GetVariable!=l){var h=a.GetVariable("$version");if(h)h=h.split(" ")[1].split(","),g.pv=[parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10)]}else if(k<10){k++;setTimeout(arguments.callee,10);return}d.removeChild(m);a=null;H()})()}else H()}function H(){var d=u.length;if(d>0)for(var m=0;m<d;m++){var a=
u[m].id,k=u[m].callbackFn,h={success:false,id:a};if(g.pv[0]>0){var f=o(a);if(f)if(b(u[m].swfVersion)&&!(g.wk&&g.wk<312)){if(c(a,true),k)h.success=true,h.ref=I(a),k(h)}else if(u[m].expressInstall&&D()){h={};h.data=u[m].expressInstall;h.width=f.getAttribute("width")||"0";h.height=f.getAttribute("height")||"0";if(f.getAttribute("class"))h.styleclass=f.getAttribute("class");if(f.getAttribute("align"))h.align=f.getAttribute("align");for(var e={},f=f.getElementsByTagName("param"),t=f.length,i=0;i<t;i++)f[i].getAttribute("name").toLowerCase()!=
"movie"&&(e[f[i].getAttribute("name")]=f[i].getAttribute("value"));y(h,e,a,k)}else B(f),k&&k(h)}else if(c(a,true),k){if((a=I(a))&&typeof a.SetVariable!=l)h.success=true,h.ref=a;k(h)}}}function I(d){var a=null;if((d=o(d))&&d.nodeName=="OBJECT")typeof d.SetVariable!=l?a=d:(d=d.getElementsByTagName(t)[0])&&(a=d);return a}function D(){return!M&&b("6.0.65")&&(g.win||g.mac)&&!(g.wk&&g.wk<312)}function y(d,a,p,k){M=true;P=k||null;R={success:false,id:p};var h=o(p);if(h){h.nodeName=="OBJECT"?(J=n(h),N=null):
(J=h,N=p);d.id=S;if(typeof d.width==l||!/%$/.test(d.width)&&parseInt(d.width,10)<310)d.width="310";if(typeof d.height==l||!/%$/.test(d.height)&&parseInt(d.height,10)<137)d.height="137";f.title=f.title.slice(0,47)+" - Flash Player Installation";k=g.ie&&g.win?"ActiveX":"PlugIn";k="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+k+"&MMdoctitle="+f.title;typeof a.flashvars!=l?a.flashvars+="&"+k:a.flashvars=k;if(g.ie&&g.win&&h.readyState!=4)k=f.createElement("div"),
p+="SWFObjectNew",k.setAttribute("id",p),h.parentNode.insertBefore(k,h),h.style.display="none",function(){h.readyState==4?h.parentNode.removeChild(h):setTimeout(arguments.callee,10)}();z(d,a,p)}}function B(d){if(g.ie&&g.win&&d.readyState!=4){var a=f.createElement("div");d.parentNode.insertBefore(a,d);a.parentNode.replaceChild(n(d),a);d.style.display="none";(function(){d.readyState==4?d.parentNode.removeChild(d):setTimeout(arguments.callee,10)})()}else d.parentNode.replaceChild(n(d),d)}function n(d){var a=
f.createElement("div");if(g.win&&g.ie)a.innerHTML=d.innerHTML;else if(d=d.getElementsByTagName(t)[0])if(d=d.childNodes)for(var p=d.length,k=0;k<p;k++)!(d[k].nodeType==1&&d[k].nodeName=="PARAM")&&d[k].nodeType!=8&&a.appendChild(d[k].cloneNode(true));return a}function z(d,a,p){var k,h=o(p);if(g.wk&&g.wk<312)return k;if(h){if(typeof d.id==l)d.id=p;if(g.ie&&g.win){var c="",b;for(b in d)if(d[b]!=Object.prototype[b])b.toLowerCase()=="data"?a.movie=d[b]:b.toLowerCase()=="styleclass"?c+=' class="'+d[b]+'"':
b.toLowerCase()!="classid"&&(c+=" "+b+'="'+d[b]+'"');b="";for(var e in a)a[e]!=Object.prototype[e]&&(b+='<param name="'+e+'" value="'+a[e]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+c+">"+b+"</object>";O[O.length]=d.id;k=o(d.id)}else{e=f.createElement(t);e.setAttribute("type",w);for(var i in d)d[i]!=Object.prototype[i]&&(i.toLowerCase()=="styleclass"?e.setAttribute("class",d[i]):i.toLowerCase()!="classid"&&e.setAttribute(i,d[i]));for(c in a)a[c]!=Object.prototype[c]&&
c.toLowerCase()!="movie"&&(d=e,b=c,i=a[c],p=f.createElement("param"),p.setAttribute("name",b),p.setAttribute("value",i),d.appendChild(p));h.parentNode.replaceChild(e,h);k=e}}return k}function C(d){var a=o(d);if(a&&a.nodeName=="OBJECT")g.ie&&g.win?(a.style.display="none",function(){if(a.readyState==4){var b=o(d);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}else setTimeout(arguments.callee,10)}()):a.parentNode.removeChild(a)}function o(a){var m=null;try{m=f.getElementById(a)}catch(b){}return m}
function a(a,m,b){a.attachEvent(m,b);E[E.length]=[a,m,b]}function b(a){var m=g.pv,a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return m[0]>a[0]||m[0]==a[0]&&m[1]>a[1]||m[0]==a[0]&&m[1]==a[1]&&m[2]>=a[2]?true:false}function e(a,m,b,c){if(!g.ie||!g.mac){var h=f.getElementsByTagName("head")[0];if(h){b=b&&typeof b=="string"?b:"screen";c&&(Q=r=null);if(!r||Q!=b)c=f.createElement("style"),c.setAttribute("type","text/css"),c.setAttribute("media",b),r=h.appendChild(c),
g.ie&&g.win&&typeof f.styleSheets!=l&&f.styleSheets.length>0&&(r=f.styleSheets[f.styleSheets.length-1]),Q=b;g.ie&&g.win?r&&typeof r.addRule==t&&r.addRule(a,m):r&&typeof f.createTextNode!=l&&r.appendChild(f.createTextNode(a+" {"+m+"}"))}}}function c(a,b){if(T){var c=b?"visible":"hidden";A&&o(a)?o(a).style.visibility=c:e("#"+a,"visibility:"+c)}}function i(a){return/[\\\"<>\.;]/.exec(a)!=null&&typeof encodeURIComponent!=l?encodeURIComponent(a):a}var l="undefined",t="object",w="application/x-shockwave-flash",
S="SWFObjectExprInst",q=window,f=document,v=navigator,U=false,K=[function(){U?L():H()}],u=[],O=[],E=[],J,N,P,R,A=false,M=false,r,Q,T=true,g=function(){var a=typeof f.getElementById!=l&&typeof f.getElementsByTagName!=l&&typeof f.createElement!=l,b=v.userAgent.toLowerCase(),c=v.platform.toLowerCase(),g=c?/win/.test(c):/win/.test(b),c=c?/mac/.test(c):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,h=!+"\u000b1",e=[0,0,0],i=null;if(typeof v.plugins!=l&&
typeof v.plugins["Shockwave Flash"]==t){if((i=v.plugins["Shockwave Flash"].description)&&!(typeof v.mimeTypes!=l&&v.mimeTypes[w]&&!v.mimeTypes[w].enabledPlugin))U=true,h=false,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),e[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),e[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),e[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof q.ActiveXObject!=l)try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(n&&(i=n.GetVariable("$version")))h=
true,i=i.split(" ")[1].split(","),e=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}catch(o){}return{w3:a,pv:e,wk:b,ie:h,win:g,mac:c}}();(function(){g.w3&&((typeof f.readyState!=l&&f.readyState=="complete"||typeof f.readyState==l&&(f.getElementsByTagName("body")[0]||f.body))&&s(),A||(typeof f.addEventListener!=l&&f.addEventListener("DOMContentLoaded",s,false),g.ie&&g.win&&(f.attachEvent("onreadystatechange",function(){f.readyState=="complete"&&(f.detachEvent("onreadystatechange",arguments.callee),
s())}),q==top&&function(){if(!A){try{f.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}s()}}()),g.wk&&function(){A||(/loaded|complete/.test(f.readyState)?s():setTimeout(arguments.callee,0))}(),G(s)))})();(function(){g.ie&&g.win&&window.attachEvent("onunload",function(){for(var a=E.length,b=0;b<a;b++)E[b][0].detachEvent(E[b][1],E[b][2]);a=O.length;for(b=0;b<a;b++)C(O[b]);for(var c in g)g[c]=null;g=null;for(var e in swfobject)swfobject[e]=null;swfobject=null})})();return{registerObject:function(a,
b,e,f){if(g.w3&&a&&b){var h={};h.id=a;h.swfVersion=b;h.expressInstall=e;h.callbackFn=f;u[u.length]=h;c(a,false)}else f&&f({success:false,id:a})},getObjectById:function(a){if(g.w3)return I(a)},embedSWF:function(a,e,f,i,h,n,o,w,q,r){var s={success:false,id:e};g.w3&&!(g.wk&&g.wk<312)&&a&&e&&f&&i&&h?(c(e,false),F(function(){f+="";i+="";var g={};if(q&&typeof q===t)for(var x in q)g[x]=q[x];g.data=a;g.width=f;g.height=i;x={};if(w&&typeof w===t)for(var u in w)x[u]=w[u];if(o&&typeof o===t)for(var v in o)typeof x.flashvars!=
l?x.flashvars+="&"+v+"="+o[v]:x.flashvars=v+"="+o[v];if(b(h))u=z(g,x,e),g.id==e&&c(e,true),s.success=true,s.ref=u;else if(n&&D()){g.data=n;y(g,x,e,r);return}else c(e,true);r&&r(s)})):r&&r(s)},switchOffAutoHideShow:function(){T=false},ua:g,getFlashPlayerVersion:function(){return{major:g.pv[0],minor:g.pv[1],release:g.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(a,b,c){if(g.w3)return z(a,b,c)},showExpressInstall:function(a,b,c,e){g.w3&&D()&&y(a,b,c,e)},removeSWF:function(a){g.w3&&C(a)},createCSS:function(a,
b,c,f){g.w3&&e(a,b,c,f)},addDomLoadEvent:F,addLoadEvent:G,getQueryParamValue:function(a){var b=f.location.search||f.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return i(b);for(var b=b.split("&"),c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("="))==a)return i(b[c].substring(b[c].indexOf("=")+1))}return""},expressInstallCallback:function(){if(M){var a=o(S);if(a&&J){a.parentNode.replaceChild(J,a);if(N&&(c(N,true),g.ie&&g.win))J.style.display="block";P&&P(R)}M=false}}}}()};(function(){function s(a,b){var e=[];bm["on"+a]=function(a){e.push(a)};bm["on"+a+"Internal"]=function(){if(b){bm.log("on"+a+"(");for(var c=0;c<arguments.length;c++)bm.log("    "+JSON.stringify(arguments[c]));bm.log(")")}if(a=="NavigationString")if((arguments[1]=="left"||arguments[1]=="right"||arguments[1]=="up"||arguments[1]=="down"||arguments[1]=="back"||arguments[1]=="activate")&&!C[arguments[0]].hackForOldNavEventsEnabled){for(var i=arguments[1],c=0;c<e.length;c++){arguments[1]=i+"Down";try{e[c].apply(bm,
arguments)}catch(l){console.log("UnhandledException ("+l+") in "+bmHooks[j]+" Callback")}arguments[1]=i+"Clicked";try{e[c].apply(bm,arguments)}catch(t){console.log("UnhandledException ("+t+") in "+bmHooks[j]+" Callback")}}arguments[1]=i+"Up"}else C[arguments[0]].hackForOldNavEventsEnabled=true;for(c=0;c<e.length;c++)try{e[c].apply(bm,arguments)}catch(n){console.log("UnhandledException ("+n+") in "+bmHooks[j]+" Callback")}}}function F(){function a(a){var b=document.createElement("div");b.id="brassmonkey-wrapper"+
Math.floor(Math.random()*281474943156225).toString(16);document.body.appendChild(b);b.style.zIndex=1E4;b.style.position="fixed";b.style.width="8px";b.style.height="8px";b.style.left="0px";b.style.bottom="0px";b.style.overflowX="hidden";b.style.overflowY="hidden";var c=document.createElement("div");c.id="brassmonkey-wrapper"+Math.floor(Math.random()*281474943156225).toString(16);b.appendChild(c);b=bm.options.name;a=typeof bm.options.design=="string"?bm.options.design:encodeURIComponent(H(bm.options.design,
a));a={bmDeviceName:b,wmode:"window",debug:"true",bmControllerXML:a};bm.wereParams&&bm.getParams.appId!==void 0&&bm.getParams.portalId!==void 0?(a.bmDeviceId=bm.getParams.appId,a.bmPortalId=bm.getParams.portalId):a.bmDeviceId=Math.floor(Math.random()*281474943156225).toString(16);bm.deviceId=a.bmDeviceId;swfobject.embedSWF(bm.options.swfURL,c.id,"1","1","9.0.124","",a,{quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",allowfullscreen:"true"},{id:"brassmonkey",name:"Play Brass Monkey",align:"middle",
style:"float:left;z-index:-1;position:absolute;margin-top:-1px;"},function(a){a.success===false&&bm.options.error!==void 0?bm.options.error("noflash"):a.success===true&&bm.options.error!==void 0&&bm.options.success()})}if(typeof bm.options.design=="string")a([]);else if(bm.options.design.images.length==0)a([]);else if(I()==-1)for(var b=0,e=Array(bm.options.design.images.length),c=0;c<bm.options.design.images.length;c++)(function(){var i=c,l=new Image;l.onload=function(){var c;c=document.createElement("canvas");
var n=c.getContext("2d");c.width=l.width;c.height=l.height;n.drawImage(l,0,0);c=c.toDataURL().replace("data:image/png;base64,","");e[i]=c;b++;b==bm.options.design.images.length&&a(e)};l.src=bm.options.design.images[c]})()}function G(a){a/=bm.options.design.orientation=="portrait"?320:480;return a}function L(a){a/=bm.options.design.orientation=="portrait"?480:320;return a}function H(a,b){var e='<?xml version="1.0" encoding="utf-8"?>\n<BMApplicationScheme version="0.1" orientation="'+a.orientation+
'" touchEnabled="'+(a.touchEnabled?"yes":"no")+'" accelerometerEnabled="'+(a.accelerometerEnabled?"yes":"no")+'">\n';if(b.length!=0){e+="<Resources>\n";for(var c=0;c<b.length;c++)e+='<Resource id="'+(c+1)+'" type="image">\n',e+="<data><![CDATA["+b[c]+"]]\></data>\n",e+="</Resource>\n";e+="</Resources>\n"}else e+="<Resources/>\n";if(a.layout.length!=0){e+="<Layout>\n";for(c=0;c<a.layout.length;c++){var i=a.layout[c].handler;a.layout[c].type=="image"&&(i="nullHandler");e+='<DisplayObject type="'+a.layout[c].type+
'" top="'+L(a.layout[c].y)+'" left="'+G(a.layout[c].x)+'" width="'+G(a.layout[c].width)+'" height="'+L(a.layout[c].height)+'" functionHandler="'+i+'">\n';a.layout[c].type=="image"?e+='<Asset name="up" resourceRef="'+(a.layout[c].image+1)+'" />\n':(e+='<Asset name="up" resourceRef="'+(a.layout[c].imageUp+1)+'" />\n',e+='<Asset name="down" resourceRef="'+(a.layout[c].imageDown+1)+'" />\n');e+="</DisplayObject>\n"}e+="</Layout>\n"}else e+="<Layout/>\n";e+="</BMApplicationScheme>";return e}function I(){var a=
-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=null&&(a=parseFloat(RegExp.$1));return a}bm={version:"0.3.0",visible:true};window.swfobject===void 0&&brassmonkeySwfObject();bm.init=function(a){bm.options=a;bm.options.logging=a.logging?a.logging:false;bm.options.swfURL=a.swfURL?a.swfURL:"http://s3.amazonaws.com/files.playbrassmonkey.com/sdks/js/v"+bm.version.replace(/\./g,"-")+"/brassmonkey.swf";bm.options.design.images=a.design.images?a.design.images:
[];bm.options.design.layout=a.design.layout?a.design.layout:[];bm.getParams={};bm.wereParams=false;document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(a,e,c){bm.getParams[decodeURIComponent(e.split("+").join(" "))]=decodeURIComponent(c.split("+").join(" "));bm.wereParams=true})};for(var D="#ff6600,#ffcc00,#ff3399,#ff0066,#cc00ff,#999900,#9999cc,#00cc99,#287200,#00ccff,#003366,#99ff00,#cc0000,#80cd68,#6600ff".split(","),y="DeviceAvailable,DeviceConnected,DeviceDisconnected,NavigationString,KeyString,Invocation,ShakeReceived,AccelReceived,Log,ShowSlot".split(","),
B=0;B<y.length;B++)s(y[B],y[B]!="AccelReceived"&&y[B]!="Log");bm.log=function(a){if(bm.options.logging)bm.onLogInternal(a)};bm.showSlotInternal=function(a){bm.onShowSlotInternal(D[(Math.max(1,a)-1)%D.length])};var n=[];bm.getControllerSlot=function(a){for(var b=0;b<n.length;b++)if(n[b]==a)return b};bm.getControllerCount=function(){for(var a=0,b=0;b<n.length;b++)n[b]!==void 0&&a++;return a};bm.getControllers=function(){for(var a=[],b=0;b<n.length;b++)n[b]!==void 0&&a.push(n[b]);return a};var z={};
bm.getDeviceName=function(a){return z[a]};var C={};bm.onDeviceConnected(function(a){z[a.deviceId]=a.deviceName;C[a.deviceId]={hackForOldNavEventsEnabled:false};for(var b=0;b<n.length;b++)if(n[b]===void 0){n[b]=a.deviceId;return}n.push(a.deviceId)});bm.onDeviceDisconnected(function(a){delete z[a.deviceId];delete C[a.deviceId];for(var b=0;b<n.length;b++)if(n[b]==a.deviceId){n[b]=void 0;break}bm.getControllerCount()});bm.isDeviceConnected=function(a){return z[a.deviceId]==void 0?false:true};var o=[];
bm.onTouchesReceived=function(a){o.push(a)};bm.onTouchesReceivedInternal=function(a){for(var b=0;b<a.touches.length;b++)for(var e=a.touches[b],c=0;c<o.length;c++)o[c](e,a.deviceId)};bm.onSocketReady=function(){};bm.setNavMode=function(a){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetNavMode!==void 0&&document.getElementById("brassmonkey").SetNavMode(typeof a==="undefined"?"":a)};bm.setKeyboardMode=function(a,b){if(document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetKeyboardMode!==
void 0){var e;document.getElementById("brassmonkey").SetKeyboardMode(typeof a==="undefined"?"":a,typeof b==="undefined"?"":b)}};bm.setGamepadMode=function(a){document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetGamepadMode!==void 0&&document.getElementById("brassmonkey").SetGamepadMode(typeof a==="undefined"?"":a)};bm.setVisibility=function(a){if(document.getElementById("brassmonkey")&&document.getElementById("brassmonkey").SetVisibility!==void 0&&bm.visible!=a)document.getElementById("brassmonkey").SetVisibility(a,
true),bm.visible=a};bm.getVisibility=function(){return bm.visible};bm.enableAccelerometer=function(a,b,e){setTimeout(function(){document.getElementById("brassmonkey").EnableAccelerometer(a,b,e)},2E3)};bm.enableTouch=function(a,b,e){setTimeout(function(){document.getElementById("brassmonkey").EnableTouch(a,b,e)},2E3)};bm.getWidth=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.width!==void 0?window.parent.passingObj.width:-1};bm.getHeight=function(){return window.parent.passingObj!==
void 0&&window.parent.passingObj.height!==void 0?window.parent.passingObj.height:-1};bm.getFullscreen=function(){return window.parent.passingObj!==void 0&&window.parent.passingObj.fullScreen!==void 0?window.parent.passingObj.fullScreen:false};window.addEventListener?window.addEventListener("DOMContentLoaded",F,false):window.attachEvent("onload",F)})();
