(function(){function c(){}var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;c.extend=function(c){function g(){!a&&this.init&&this.init.apply(this,arguments)}var d=this.prototype;a=!0;var e=new this;a=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);return this._super=c,e}}(f,c[f]):c[f];return g.prototype=e,g.prototype.constructor=g,g.extend=arguments.callee,g},EventEmitter=c.extend({init:function(){this.callbacks={}},addEventListener:function(a,b){if(typeof b!="function")throw new Error(".on() callback provided was not a function");this.callbacks[a]===undefined&&(this.callbacks[a]=[]),this.callbacks[a].push(b)},on:function(a,b){this.addEventListener(a,b)},removeEventListener:function(a,b){if(this.callbacks[a]!==undefined){var c,d=this.callbacks[a];for(var c=0;c<d.length;c++)if(d[c]==b){d.splice(c,1);return}}},off:function(a,b){this.removeEventListener(a,b)},trigger:function(a,b){if(this.callbacks[a]!==undefined){var c,d=this.callbacks[a];for(var c=0;c<d.length;c++)d[c](b)}},triggerWithType:function(a,b){b.type=a,this.trigger(a,b)}});var d=function(a){a=a.split("+").join(" ");var b={},c,d=/[?&]?([^=]+)=([^&]*)/g;while(c=d.exec(a))b[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);return b},e=EventEmitter.extend({init:function(){this._super(),this.version="0.5.0",this.devices={}},start:function(a){this.options=a;var b=d(document.location.search);a.deviceId=b.appId||Math.floor(Math.random()*16777215*16777215).toString(16),a.portalId=b.portalId,bm.detectRuntime()=="websockets"?this.runtime=new bm.WebSocketsRT:this.runtime=new bm.FlashRT,this.runtime.start(a)},stop:function(){bm.runtime!==undefined&&bm.runtime.stop()},log:function(a){return},addDevice:function(a){this.devices[a.id]=a,this.triggerWithType("deviceconnected",{device:a})},removeDevice:function(a){a.id in this.devices&&(delete this.devices[a.id],this.triggerWithType("devicedisconnected",{device:a}))},getDevice:function(a){return this.devices[a]}});bm=BrassMonkey=new e,bm.EventEmitter=EventEmitter,bm.Class=c,console!==undefined&&console.log!==undefined?bm.log=function(){console.log.apply(console,arguments)}:bm.log=function(){},window.boomBa=function(a){console.log(a)};var f=function(a,b){return function(){for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];d[b].apply(d,arguments)}}};bm.allDevices=function(){var a={},b=bm.devices,c=["setMode","enableTouch"];for(var d=0;d<c.length;++d)a[c[d]]=f(b,c[d]);return function(){return a}}(),bm.slotColors=["#ff6600","#ffcc00","#ff3399","#ff0066","#cc00ff","#999900","#9999cc","#00cc99","#287200","#00ccff","#003366","#99ff00","#cc0000","#80cd68","#6600ff"]})(),function(a){function b(){this.buffer=[]}function d(a){this._input=a,this._index=-1,this._buffer=[],this.byteCount=0}function e(a){this._input=a,this._index=-1,this._buffer=[]}b.prototype.append=function(a){return this.buffer.push(a),this},b.prototype.toString=function(){return this.buffer.join("")};var c={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var c=new b,e=new d(a);while(e.moveNext()){var f=e.current;e.moveNext();var g=e.current;e.moveNext();var h=e.current,i=f>>2,j=(f&3)<<4|g>>4,k=(g&15)<<2|h>>6,l=h&63;isNaN(g)?k=l=64:isNaN(h)&&(l=64),c.append(this.codex.charAt(i)+this.codex.charAt(j)+this.codex.charAt(k)+this.codex.charAt(l))}return[e.byteCount,c.toString()]},decode:function(a){var c=new b,d=new e(a);while(d.moveNext()){var f=d.current;if(f<128)c.append(String.fromCharCode(f));else if(f>191&&f<224){d.moveNext();var g=d.current;c.append(String.fromCharCode((f&31)<<6|g&63))}else{d.moveNext();var g=d.current;d.moveNext();var h=d.current;c.append(String.fromCharCode((f&15)<<12|(g&63)<<6|h&63))}}return c.toString()}};d.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var a=this._input.charCodeAt(++this._index);return a==13&&this._input.charCodeAt(this._index+1)==10&&(a=10,this._index+=2),a<128?(this.current=a,this.byteCount+=1):a>127&&a<2048?(this.current=a>>6|192,this._buffer.push(a&63|128),this.byteCount+=2):(this.current=a>>12|224,this._buffer.push(a>>6&63|128),this._buffer.push(a&63|128),this.byteCount+=3),!0}},e.prototype={current:64,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var a=c.codex.indexOf(this._input.charAt(++this._index)),b=c.codex.indexOf(this._input.charAt(++this._index)),d=c.codex.indexOf(this._input.charAt(++this._index)),e=c.codex.indexOf(this._input.charAt(++this._index)),f=a<<2|b>>4,g=(b&15)<<4|d>>2,h=(d&3)<<6|e;return this.current=f,d!=64&&this._buffer.push(g),e!=64&&this._buffer.push(h),!0}},a.Base64=c}(BrassMonkey),function(a){function b(a){var b=document.createElement("canvas"),c=b.getContext("2d");b.width=a.width,b.height=a.height,c.drawImage(a,0,0);var d=b.toDataURL().replace("data:image/png;base64,","");return d}function c(b,c){var d,e;a.options.design.orientation=="portrait"?(d=320,e=480):(d=480,e=320);var f='<?xml version="1.0" encoding="utf-8"?>\n<BMApplicationScheme version="0.1" orientation="'+b.orientation+'" touchEnabled="'+(b.touchEnabled?"yes":"no")+'" accelerometerEnabled="'+(b.accelerometerEnabled?"yes":"no")+'">\n';if(c.length!=0){f+="<Resources>\n";for(var g=0;g<c.length;g++)f+='<Resource id="'+(g+1)+'" type="image">\n',f+="<data><![CDATA["+c[g]+"]]></data>\n",f+="</Resource>\n";f+="</Resources>\n"}else f+="<Resources/>\n";if(b.layout.length!=0){f+="<Layout>\n";for(var g=0;g<b.layout.length;g++){var h=b.layout[g].handler;b.layout[g].type=="image"&&(h="nullHandler"),f+='<DisplayObject type="'+b.layout[g].type+'" top="'+b.layout[g].y/e+'" left="'+b.layout[g].x/d+'" width="'+b.layout[g].width/d+'" height="'+b.layout[g].height/e+'" functionHandler="'+h+'">\n',b.layout[g].type=="image"?f+='<Asset name="up" resourceRef="'+(b.layout[g].image+1)+'" />\n':(f+='<Asset name="up" resourceRef="'+(b.layout[g].imageUp+1)+'" />\n',f+='<Asset name="down" resourceRef="'+(b.layout[g].imageDown+1)+'" />\n'),f+="</DisplayObject>\n"}f+="</Layout>\n"}else f+="<Layout/>\n";return f+="</BMApplicationScheme>",f}a.loadImages=function(a,c){if(a.length==0){c([]);return}var d=0,e=new Array(a.length);for(var f=0;f<a.length;f++)(function(){var g=f,h=new Image;h.onload=function(){e[g]=b(h),d++,d==a.length&&c(e)},h.src=a[g]})()},a.generateControllerXML=function(b){var d=c(a.options.design,b);return d}}(BrassMonkey),function(a){a.Device=a.EventEmitter.extend({init:function(){this._super(),this.name="Name",this.id="fad2fd2fda2f2f",this.touchEnabled=!1,this.touchInterval=.1,this.accelerometerEnabled=!1,this.accelerometerInterval=.1,this.gyroEnabled=!1,this.gyroInterval=.1,this.orientationEnabled=!1,this.orientationInterval=.1,this.capabilities=0,this.mode="gamepad"},getMode:function(a){return this.mode},hasCapability:function(a){if(a in b)return(this.capabilities&b[a])!==0;throw new Error("unknown capability "+a)}});var b={gyroscope:1,orientation:2}}(BrassMonkey),function(a){var b="iphone",c="ipod",d="ipad",e=navigator.userAgent.toLowerCase();a.detectIphone=function(){return e.search(b)>-1},a.detectIpad=function(){return e.search(d)>-1},a.detectIpod=function(){return e.search(c)>-1},a.detectIOS=function(){return a.detectIphone()?!0:a.detectIpod()?!0:a.detectIpad()?!0:!1},a.detectAndroid=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("android")>-1},a.detectInternetExplorerVersion=function(){var a=-1;if(navigator.appName=="Microsoft Internet Explorer"){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(b)!=null&&(a=parseFloat(RegExp.$1))}return a},a.detectRuntime=function(){return"websockets"}}(BrassMonkey),function(a){a.defineSWFObject=function(){swfobject=function(){function A(){if(t)return;try{var a=i.getElementsByTagName("body")[0].appendChild(Q("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;var c=l.length;for(var d=0;d<c;d++)l[d]()}function B(a){t?a():l[l.length]=a}function C(b){if(typeof h.addEventListener!=a)h.addEventListener("load",b,!1);else if(typeof i.addEventListener!=a)i.addEventListener("load",b,!1);else if(typeof h.attachEvent!=a)R(h,"onload",b);else if(typeof h.onload=="function"){var c=h.onload;h.onload=function(){c(),b()}}else h.onload=b}function D(){k?E():F()}function E(){var c=document.body,d=Q(b),f=c.appendChild(d);d.setAttribute("type",e);if(f){var g=0;(function(){if(typeof f.GetVariable!=a){var b=f.GetVariable("$version");b&&(b=b.split(" ")[1].split(","),y.pv=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)])}else if(g<10){g++,setTimeout(arguments.callee,10);return}c.removeChild(d),f=null,F()})()}else F()}function F(){var b=m.length;if(b>0)for(var c=0;c<b;c++){var d=m[c].id,e=m[c].callbackFn,f={success:!1,id:d};if(y.pv[0]>0){var g=P(d);if(g)if(S(m[c].swfVersion)&&!(y.wk&&y.wk<312))U(d,!0),e&&(f.success=!0,f.ref=G(d),e(f));else if(m[c].expressInstall&&H()){var h={};h.data=m[c].expressInstall,h.width=g.getAttribute("width")||"0",h.height=g.getAttribute("height")||"0",g.getAttribute("class")&&(h.styleclass=g.getAttribute("class")),g.getAttribute("align")&&(h.align=g.getAttribute("align"));var i={},j=g.getElementsByTagName("param"),k=j.length;for(var l=0;l<k;l++)j[l].getAttribute("name").toLowerCase()!="movie"&&(i[j[l].getAttribute("name")]=j[l].getAttribute("value"));I(h,i,d,e)}else J(g),e&&e(f)}else{U(d,!0);if(e){var n=G(d);n&&typeof n.SetVariable!=a&&(f.success=!0,f.ref=n),e(f)}}}}function G(c){var d=null,e=P(c);if(e&&e.nodeName=="OBJECT")if(typeof e.SetVariable!=a)d=e;else{var f=e.getElementsByTagName(b)[0];f&&(d=f)}return d}function H(){return!u&&S("6.0.65")&&(y.win||y.mac)&&!(y.wk&&y.wk<312)}function I(b,c,d,e){u=!0,r=e||null,s={success:!1,id:d};var g=P(d);if(g){g.nodeName=="OBJECT"?(p=K(g),q=null):(p=g,q=d),b.id=f;if(typeof b.width==a||!/%$/.test(b.width)&&parseInt(b.width,10)<310)b.width="310";if(typeof b.height==a||!/%$/.test(b.height)&&parseInt(b.height,10)<137)b.height="137";i.title=i.title.slice(0,47)+" - Flash Player Installation";var h=y.ie&&y.win?"ActiveX":"PlugIn",j="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+h+"&MMdoctitle="+i.title;typeof c.flashvars!=a?c.flashvars+="&"+j:c.flashvars=j;if(y.ie&&y.win&&g.readyState!=4){var k=Q("div");d+="SWFObjectNew",k.setAttribute("id",d),g.parentNode.insertBefore(k,g),g.style.display="none",function(){g.readyState==4?g.parentNode.removeChild(g):setTimeout(arguments.callee,10)}()}L(b,c,d)}}function J(a){if(y.ie&&y.win&&a.readyState!=4){var b=Q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(K(a),b),a.style.display="none",function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(K(a),a)}function K(a){var c=Q("div");if(y.win&&y.ie)c.innerHTML=a.innerHTML;else{var d=a.getElementsByTagName(b)[0];if(d){var e=d.childNodes;if(e){var f=e.length;for(var g=0;g<f;g++)(e[g].nodeType!=1||e[g].nodeName!="PARAM")&&e[g].nodeType!=8&&c.appendChild(e[g].cloneNode(!0))}}}return c}function L(c,d,f){var g,h=P(f);if(y.wk&&y.wk<312)return g;if(h){typeof c.id==a&&(c.id=f);if(y.ie&&y.win){var i="";for(var j in c)c[j]!=Object.prototype[j]&&(j.toLowerCase()=="data"?d.movie=c[j]:j.toLowerCase()=="styleclass"?i+=' class="'+c[j]+'"':j.toLowerCase()!="classid"&&(i+=" "+j+'="'+c[j]+'"'));var k="";for(var l in d)d[l]!=Object.prototype[l]&&(k+='<param name="'+l+'" value="'+d[l]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+k+"</object>",n[n.length]=c.id,g=P(c.id)}else{var m=Q(b);m.setAttribute("type",e);for(var o in c)c[o]!=Object.prototype[o]&&(o.toLowerCase()=="styleclass"?m.setAttribute("class",c[o]):o.toLowerCase()!="classid"&&m.setAttribute(o,c[o]));for(var p in d)d[p]!=Object.prototype[p]&&p.toLowerCase()!="movie"&&M(m,p,d[p]);h.parentNode.replaceChild(m,h),g=m}}return g}function M(a,b,c){var d=Q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function N(a){var b=P(a);b&&b.nodeName=="OBJECT"&&(y.ie&&y.win?(b.style.display="none",function(){b.readyState==4?O(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function O(a){var b=P(a);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}function P(a){var b=null;try{b=i.getElementById(a)}catch(c){}return b}function Q(a){return i.createElement(a)}function R(a,b,c){a.attachEvent(b,c),o[o.length]=[a,b,c]}function S(a){var b=y.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function T(c,d,e,f){if(y.ie&&y.mac)return;var g=i.getElementsByTagName("head")[0];if(!g)return;var h=e&&typeof e=="string"?e:"screen";f&&(v=null,w=null);if(!v||w!=h){var j=Q("style");j.setAttribute("type","text/css"),j.setAttribute("media",h),v=g.appendChild(j),y.ie&&y.win&&typeof i.styleSheets!=a&&i.styleSheets.length>0&&(v=i.styleSheets[i.styleSheets.length-1]),w=h}y.ie&&y.win?v&&typeof v.addRule==b&&v.addRule(c,d):v&&typeof i.createTextNode!=a&&v.appendChild(i.createTextNode(c+" {"+d+"}"))}function U(a,b){if(!x)return;var c=b?"visible":"hidden";t&&P(a)?P(a).style.visibility=c:T("#"+a,"visibility:"+c)}function V(b){var c=/[\\\"<>\.;]/,d=c.exec(b)!=null;return d&&typeof encodeURIComponent!=a?encodeURIComponent(b):b}var a="undefined",b="object",c="Shockwave Flash",d="ShockwaveFlash.ShockwaveFlash",e="application/x-shockwave-flash",f="SWFObjectExprInst",g="onreadystatechange",h=window,i=document,j=navigator,k=!1,l=[D],m=[],n=[],o=[],p,q,r,s,t=!1,u=!1,v,w,x=!0,y=function(){var f=typeof i.getElementById!=a&&typeof i.getElementsByTagName!=a&&typeof i.createElement!=a,g=j.userAgent.toLowerCase(),l=j.platform.toLowerCase(),m=l?/win/.test(l):/win/.test(g),n=l?/mac/.test(l):/mac/.test(g),o=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,p=!1,q=[0,0,0],r=null;if(typeof j.plugins!=a&&typeof j.plugins[c]==b)r=j.plugins[c].description,r&&(typeof j.mimeTypes==a||!j.mimeTypes[e]||!!j.mimeTypes[e].enabledPlugin)&&(k=!0,p=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),q[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),q[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof h.ActiveXObject!=a)try{var s=new ActiveXObject(d);s&&(r=s.GetVariable("$version"),r&&(p=!0,r=r.split(" ")[1].split(","),q=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(t){}return{w3:f,pv:q,wk:o,ie:p,win:m,mac:n}}(),z=function(){if(!y.w3)return;(typeof i.readyState!=a&&i.readyState=="complete"||typeof i.readyState==a&&(i.getElementsByTagName("body")[0]||i.body))&&A(),t||(typeof i.addEventListener!=a&&i.addEventListener("DOMContentLoaded",A,!1),y.ie&&y.win&&(i.attachEvent(g,function(){i.readyState=="complete"&&(i.detachEvent(g,arguments.callee),A())}),h==top&&function(){if(t)return;try{i.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}A()}()),y.wk&&function(){if(t)return;if(!/loaded|complete/.test(i.readyState)){setTimeout(arguments.callee,0);return}A()}(),C(A))}(),W=function(){y.ie&&y.win&&window.attachEvent("onunload",function(){var a=o.length;for(var b=0;b<a;b++)o[b][0].detachEvent(o[b][1],o[b][2]);var c=n.length;for(var d=0;d<c;d++)N(n[d]);for(var e in y)y[e]=null;y=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(y.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,m[m.length]=e,U(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(y.w3)return G(a)},embedSWF:function(c,d,e,f,g,h,i,j,k,l){var m={success:!1,id:d};y.w3&&!(y.wk&&y.wk<312)&&c&&d&&e&&f&&g?(U(d,!1),B(function(){e+="",f+="";var n={};if(k&&typeof k===b)for(var o in k)n[o]=k[o];n.data=c,n.width=e,n.height=f;var p={};if(j&&typeof j===b)for(var q in j)p[q]=j[q];if(i&&typeof i===b)for(var r in i)typeof p.flashvars!=a?p.flashvars+="&"+r+"="+i[r]:p.flashvars=r+"="+i[r];if(S(g)){var s=L(n,p,d);n.id==d&&U(d,!0),m.success=!0,m.ref=s}else{if(h&&H()){n.data=h,I(n,p,d,l);return}U(d,!0)}l&&l(m)})):l&&l(m)},switchOffAutoHideShow:function(){x=!1},ua:y,getFlashPlayerVersion:function(){return{major:y.pv[0],minor:y.pv[1],release:y.pv[2]}},hasFlashPlayerVersion:S,createSWF:function(a,b,c){return y.w3?L(a,b,c):undefined},showExpressInstall:function(a,b,c,d){y.w3&&H()&&I(a,b,c,d)},removeSWF:function(a){y.w3&&N(a)},createCSS:function(a,b,c,d){y.w3&&T(a,b,c,d)},addDomLoadEvent:B,addLoadEvent:C,getQueryParamValue:function(a){var b=i.location.search||i.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return V(b);var c=b.split("&");for(var d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return V(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(u){var a=P(f);a&&p&&(a.parentNode.replaceChild(p,a),q&&(U(q,!0),y.ie&&y.win&&(p.style.display="block")),r&&r(s)),u=!1}}}}()},window.swfobject===undefined&&a.defineSWFObject()}(BrassMonkey),function(a){function b(){function b(a){var b=document.createElement("canvas"),c=b.getContext("2d");b.width=a.width,b.height=a.height,c.drawImage(a,0,0);var d=b.toDataURL().replace("data:image/png;base64,","");return d}function c(b){var c=document.createElement("div");c.id="brassmonkey-wrapper"+Math.floor(Math.random()*16777215*16777215).toString(16),document.body.appendChild(c),c.style.zIndex=1e4,c.style.position="fixed",c.style.width="8px",c.style.height="8px",c.style.left="0px",c.style.bottom="0px",c.style.overflowX="hidden",c.style.overflowY="hidden";var d=document.createElement("div");d.id="brassmonkey-wrapper"+Math.floor(Math.random()*16777215*16777215).toString(16),c.appendChild(d);var e="9.0.124",f={bmDeviceName:a.options.name,bmControllerXML:encodeURIComponent(a.generateControllerXML(b)),wmode:"window",debug:"true"},g=Math.floor(Math.random()*16777215*16777215).toString(16);window["bm"+g]=a,f.globalName=g,a.wereParams&&a.getParams.appId!==undefined&&a.getParams.portalId!==undefined?(f.bmDeviceId=a.getParams.appId,f.bmPortalId=a.getParams.portalId):f.bmDeviceId=Math.floor(Math.random()*16777215*16777215).toString(16),a.deviceId=f.bmDeviceId,f.bmMaxPlayers=a.options.bmMaxPlayers!==undefined?a.options.bmMaxPlayers:96;var h={};h.quality="high",h.bgcolor="#ffffff",h.allowscriptaccess="always",h.allowfullscreen="true";var i={};i.id=a.runtime.flashObjID,i.name="Play Brass Monkey",i.align="middle",i.style="float:left;z-index:-1;position:absolute;margin-top:-1px;",swfobject.embedSWF(a.options.swfURL,d.id,"1","1",e,"",f,h,i,function(b){b.success===!1&&a.options.error!==undefined?a.options.error("noflash"):b.success===!0&&a.options.error!==undefined&&a.options.success()})}typeof a.options.design=="string"?c([]):a.options.design.images.length==0?c([]):a.detectInternetExplorerVersion()==-1&&a.loadImages(a.options.design.images,function(a){c(a)})}a.FlashRT=a.Class.extend({init:function(){this.flashObjID=Math.floor(Math.random()*16777215*16777215).toString(16)},start:function(){a.options.swfURL=a.options.swfURL?a.options.swfURL:"http://s3.amazonaws.com/files.playbrassmonkey.com/sdks/js/v"+a.version.replace(/\./g,"-")+"/brassmonkey.swf"},stop:function(){},getFlashObject:function(){return document.getElementById(flashObjID)},showSlotColor:function(a){console.log(a)}}),a.detectRuntime()=="flash"&&(window.addEventListener?window.addEventListener("DOMContentLoaded",b,!1):window.attachEvent("onload",b))}(BrassMonkey),function(a){function bc(a){return(a.major&255)<<24|(a.minor&255)<<16}function bd(a){return{major:a>>24&255,minor:a>>16&255}}function bf(a){var b=bh[a[0]];if(b)return b(a);throw new Error("no decoder for "+a)}function bg(a){var b=bi[a.encodeType];if(b)return b(a);throw new Error("no encoder for "+a)}function bj(a){var b={},c=0;return b.channel=a[++c],b.sequence=a[++c],b.timestamp=a[++c],b.rtt=a[++c],b.type=a[++c],b.deviceType=a[++c],b.deviceId=a[++c],b.deviceName=a[++c],a[++c]&&(b.message=bf(a[++c])),b}function bk(a){return[v,a.channel,a.sequence,0,0,a.type,a.deviceType,a.deviceId,a.deviceName,!0,bg(a.message)]}function bl(a){return{hostname:a[1],udpPort:a[2],tcpPort:a[3]}}function bm(a){return[w,a.hostname,a.udpPort,a.tcpPort]}function bn(a){var b=a[1],c=a[2];return b==="@"&&(c=bf(c)),[b,c]}function bo(a){return[x,a[0],a[0]==="@"?bg(a[1]):a[1]]}function bp(a){var b=0,c=[],d={};++b,d.method=a[++b],d.returnMethod=a[++b],d.params=c;var e=a[++b],f=b+e;while(b<f)c.push(bn(a[++b]));return d}function bq(a){var b=a.params,c=[y,0,a.method,a.returnMethod,b.length],d;for(d=0;d<b.length;++d)c.push(bo(b[d]));return c}function br(a){return{x:a[1],y:a[2],z:a[3]}}function bs(a){return{encodeType:a[0],type:a[1],id:a[2],name:a[3]}}function bt(a){return[a.encodeType,a.type,a.id,a.name]}function bx(){function f(a,b){var c=365,d=new Date;d.setDate(d.getDate()+c);var e=escape(b)+(c===null?"":"; expires="+d.toUTCString());document.cookie=a+"="+e}function g(a){var b,c,d,e=document.cookie.split(";");for(b=0;b<e.length;b++){c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,"");if(c===a)return unescape(d)}}var b=document.createElement("div");document.body.insertBefore(b,document.body.firstChild),b.style.width="273px",b.style.height="23px",b.style.position="absolute",b.style.overflow="hidden",b.style.border="thin solid grey",b.style.backgroundColor="white";var c=document.createElement("input");c.setAttribute("type","button"),c.setAttribute("value","Start"),c.setAttribute("name","start"),c.onclick=function(){f("ipaddress",d.value),a.loadImages(a.options.design.images,function(b){var c=a.generateControllerXML(b);bv=bw(c),Y(d.value)})},b.appendChild(c);var d=document.createElement("input");d.style.width="120px",d.setAttribute("type","text"),d.setAttribute("name","");var e=g("ipaddress");e?d.setAttribute("value",e):d.setAttribute("value","<ipaddress>"),b.appendChild(d)}"use strict";var b=0,c=1,d=2,e=3,f=4,g=5,h=0,i=1,j=2,k=3,l=4,m=5,n=6,o=7,p=0,q=1,r=2,s=3,t=4,u=5,v=0,w=1,x=3,y=4,z=5,A=6,B=7,C=8,D=10,E=15,F=16,G=17,H=18,I=9,J=11,K=13,L=14,M=19,N=21,O=22,P=23,Q={gamepad:0,keyboard:1,navigation:2,wait:3},R=[],S=bc({major:1,minor:4}),T={id:"sadkldsjadsjladsjklsaklasdkljsadla",name:"dorian",type:s,encodeType:H},U={hostname:"unknown",updPort:0,tcpPort:0,encodeType:w},V=function(b){var c=R.indexOf(R);c>=0&&(R.splice(c,1),a.removeDevice(b))},W=function(a,b){return function(){a.apply(b,arguments)}},X=function(a,b){return{method:a,returnMethod:"",params:b,encodeType:y}},Y=function(b){a.log("start"),R.push(new $("deviceId",b,9011))},Z=function(){var b;for(b=0;b<R.length;++b)a.removeDevice(R[b]),R[b].close();R.length=0,a.log("stop")},$=a.Device.extend({init:function(b,c,d){var e;this._super(),this.id=b,e=this.socket=new WebSocket("ws://"+c+":"+d),this.sequence=0,this.capabilities=0,this.touchEnabled=a.options.design.touchEnabled,this.accelerometerEnabled=a.options.design.accelerometerEnabled;var f=this;e.onerror=W(this.onError,this),e.onclose=W(this.onClose,this),e.onmessage=W(this.onVersion,this),e.onopen=W(this.onOpen,this)},onError:function(){V(this),a.log("error")},onClose:function(){V(this),a.log("DISCONNECTED")},onOpen:function(){var b=[S,S];this.socket.send(JSON.stringify(b)),a.log("CONNECTED")},onVersion:function(b){var c=JSON.parse(b.data);a.log("GOT VERSION"),this.sendPacket({type:d,message:{encodeType:I,device:T,address:U}}),this.sendInvoke("setReliabilityForTouch",[["i",2],["i",2]]),this.socket.onmessage=W(this.onMessage,this)},setMode:function(a,b){if(this.mode!==a){if(!(a in Q))throw new Error("unknown control mode "+a);this.mode=a;var c=Q[a];b!==undefined?this.sendInvoke("SetControlMode",[["i",c],["*",b]]):this.sendInvoke("SetControlMode",[["i",c]])}},enableGyroscope:function(a){a!==this.gyroEnabled&&(this.gyroEnabled=a,this.sendInvoke("enableGyro",[["B",a]]))},setGyroscopeInterval:function(a){a!==this.gyroInterval&&(this.gyroInterval=a,this.sendInvoke("setGyroInterval",[["f",a]]))}}),_=$.prototype,ba=function(a){var b=a.charAt(0).toUpperCase()+a.slice(1),c=a+"Enabled",d=a+"Interval",e="enable"+b,f="set"+b+"Interval";_[e]=function(a){a!==this[c]&&(this[c]=a,this.sendInvoke(e,[["B",a]]))},_[f]=function(a){a!==this[d]&&(this[d]=a,this.sendInvoke(f,[["f",a]]))}};ba("touch"),ba("accelerometer"),ba("orientation");var bb=function(b,c,d){a.log("notify: "+c),b.trigger(c,d),a.trigger(c,d)};_.onMessage=function(a){var b=JSON.parse(a.data),c=bj(b),d=c.channel;if(k===d)this.handleInvoke(c.message);else if(l===d)bb(this,"shake",{device:this});else if(i===d)bb(this,"acceleration",{device:this,acceleration:c.message});else if(j===d){var e=c.message.touches,f=e.length;console.log(f);for(var g=0;g<f;g++)switch(e[g].phase){case 1:bb(this,"touchstart",{device:this,x:e[g].x,y:e[g].y,id:this.id+e[g].id});break;case 2:bb(this,"touchmove",{device:this,x:e[g].x,y:e[g].y,id:this.id+e[g].id});break;case 4:bb(this,"touchend",{device:this,x:e[g].x,y:e[g].y,id:this.id+e[g].id})}}else n===d?bb(this,"gyroscope",{device:this,gyroscope:c.message}):o===d&&bb(this,"orientation",{device:this,orientation:c.message})},_.close=function(){this.socket.close()},_.handleInvoke=function(b){switch(b.method){case"RequestXML":this.sendControlScheme();break;case"GetPortalId":a.options.portalId&&this.sendInvoke(b.returnMethod,[["*",a.options.portalId]]);break;case"setCapabilities":this.capabilities=b.params[0][1],a.addDevice(this);break;case"onKeyString":bb(this,"keyboard",{device:this,text:b.params[0][1]});break;case"onControlSchemeParsed":break;case"WaitCancelled":bb(this,"waitcancelled",{device:this});break;case"bmPause":bb(this,"pause",{device:this});break;case"onNavigationString":bb(this,"navstring",{device:this,string:b.params[0][1]});break;default:this.handleButtonInvoke(b)}},_.handleButtonInvoke=function(a){var b;if(a.params.length!==1)return;var c=a.params[0][1];c==="up"?bb(this,"buttonup",{device:this,button:a.method}):c==="down"&&bb(this,"buttondown",{device:this,button:a.method})},_.sendControlScheme=function(){for(var a=0;a<bv.length;++a)this.sendPacket({channel:m,message:bv[a]})},_.sendInvoke=function(a,b){this.sendPacket({channel:k,message:X(a,b)})},_.sendPacket=function(a){a.sequence=++this.sequence,a.deviceId=T.id,a.deviceType=T.type,a.channel=a.channel||h,a.type=a.type||b,a.rtt=0,a.timestamp=0;var c=bk(a);this.socket.send(JSON.stringify(c))};var be=!1,bh=[],bi=[];bh[v]=bj,bi[v]=bk,bh[w]=bl,bi[w]=bm,bh[x]=bn,bi[x]=bo,bh[y]=bp,bi[y]=bq,bh[z]=br,be&&(bi[z]=function(a){return[z,a.x,a.y,a.z]}),bh[A]=function(a){var b=0,c=a[++b],d=[],e;for(e=0;e<c;++e){var f={};f.x=a[++b],f.y=a[++b],f.viewWidth=a[++b],f.viewHeight=a[++b],f.phase=a[++b],f.id=a[++b],d.push(f)}return{touches:d}},be&&(bi[A]=function(a){var b=a.touches,c=[A,b.length],d;for(d=0;d<b.length;++d){var e=b[d];c.push(e.x),c.push(e.y),c.push(e.viewWidth),c.push(e.viewHeight),c.push(e.phase),c.push(e.id)}return c});var bu=function(a){bh[a]=bs,bi[a]=bt};bu(B),bu(C),bu(D),bu(E),bu(F),bu(H),bh[I]=function(a){return{device:bs(a[1]),address:bl(a[2])}},bi[I]=function(a){return[I,bt(a.device),bm(a.address)]},bh[J]=function(a){return{uid:a[1],address:bl(a[2])}},bi[J]=function(a){return[J,a.uid,bm(a.address)]},bh[K]=function(){return{}},bi[K]=function(){return[K,0]},bh[L]=function(a){return{setId:a[1],startByte:a[2],chunkSize:a[3],totalSize:a[4],data:a[5]}},bi[L]=function(a){return[L,a.setId,a.startByte,a.chunkSize,a.totalSize,a.data]},bh[M]=function(a){var b=0,c={};return c.device=bs(a[++b]),c.address=bl(a[++b]),c.appId=a[++b],c.slotId=a[++b],c.slotId>0&&(c.currentPlayers=a[++b],c.maxPlayers=a[++b]),c},bi[M]=function(a){var b=[M,bt(a.device),bm(a.address),a.appId,a.slotId];return a.slotId>0&&(b.push(a.currentPlayers),b.push(a.maxPlayers)),b},bh[O]=function(a){return{x:a[1],y:a[2],z:a[3]}},be&&(bi[O]=function(a){return[O,a.x,a.y,a.z]}),bh[P]=function(a){return{x:a[1],y:a[2],z:a[3],w:a[4]}},be&&(bi[P]=function(a){return[P,a.x,a.y,a.z,a.w]});var bv,bw=function(b){var c=32768,d=[],e=b.length,f=0,g=0;for(f=0;f<e;f+=c){var h=a.Base64.encode(b.substr(f,c)),i=h[0],j=h[1];d.push({encodeType:L,setId:"testXML",startByte:g,chunkSize:i,data:j}),g+=i}for(var k=0;k<d.length;++k)d[k].totalSize=g;return d};a.detectRuntime()==="websockets"&&(window.addEventListener?window.addEventListener("DOMContentLoaded",bx,!1):window.attachEvent("onload",bx)),a.WebSocketsRT=a.Class.extend({init:function(){},start:function(b){T.id=b.deviceId,T.name=b.name,a.log(b.deviceId)},stop:function(){Z()}})}(BrassMonkey);