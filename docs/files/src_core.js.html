<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src&#x2F;core.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/bm.html">bm</a></li>
            
                <li><a href="..&#x2F;classes/bm.Device.html">bm.Device</a></li>
            
                <li><a href="..&#x2F;classes/bm.EventEmitter.html">bm.EventEmitter</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src&#x2F;core.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
(function(){

&#x2F;* Simple JavaScript Inheritance
 * By John Resig http:&#x2F;&#x2F;ejohn.org&#x2F;
 * MIT Licensed.
 *&#x2F;
&#x2F;&#x2F; Inspired by base2 and Prototype
var initializing = false, fnTest = &#x2F;xyz&#x2F;.test(function(){xyz;}) ? &#x2F;\b_super\b&#x2F; : &#x2F;.*&#x2F;;
&#x2F;&#x2F; The base Class implementation (does nothing)
function Class(){};

&#x2F;&#x2F; Create a new Class that inherits from this class
Class.extend = function(prop) {
  var _super = this.prototype;
  
  &#x2F;&#x2F; Instantiate a base class (but only create the instance,
  &#x2F;&#x2F; don&#x27;t run the init constructor)
  initializing = true;
  var prototype = new this();
  initializing = false;
  
  &#x2F;&#x2F; Copy the properties over onto the new prototype
  for (var name in prop) {
    &#x2F;&#x2F; Check if we&#x27;re overwriting an existing function
    prototype[name] = typeof prop[name] == &quot;function&quot; &amp;&amp; 
      typeof _super[name] == &quot;function&quot; &amp;&amp; fnTest.test(prop[name]) ?
      (function(name, fn){
        return function() {
          var tmp = this._super;
          
          &#x2F;&#x2F; Add a new ._super() method that is the same method
          &#x2F;&#x2F; but on the super-class
          this._super = _super[name];
          
          &#x2F;&#x2F; The method only need to be bound temporarily, so we
          &#x2F;&#x2F; remove it when we&#x27;re done executing
          var ret = fn.apply(this, arguments);        
          this._super = tmp;
          
          return ret;
        };
      })(name, prop[name]) :
      prop[name];
  }
  
  &#x2F;&#x2F; The dummy class constructor
  function Class() {
    &#x2F;&#x2F; All construction is actually done in the init method
    if ( !initializing &amp;&amp; this.init )
      this.init.apply(this, arguments);
  }
  
  &#x2F;&#x2F; Populate our constructed prototype object
  Class.prototype = prototype;
  
  &#x2F;&#x2F; Enforce the constructor to be what we expect
  Class.prototype.constructor = Class;

  &#x2F;&#x2F; And make this class extendable
  Class.extend = arguments.callee;
  
  return Class;
};


&#x2F;**
EventEmitter implements an interface for registering, unregistering, and triggering events.

@class bm.EventEmitter
**&#x2F;
EventEmitter = Class.extend({
  init:function(){
    this.callbacks = {};
  },
  &#x2F;**
  Register a callback for a particular event.
  
  @method addEventListener
  @param {String} eventType Which event to listen to.
    Examples: 
        
        &quot;buttondown&quot;, &quot;buttonup&quot;, or &quot;shake&quot;
        
        
  @param {Function} fn Function to be called back when the event occurs.
  
  **&#x2F;

  addEventListener: function(eventType,fn){
    if (typeof fn !== &#x27;function&#x27;){
      throw new Error(&#x27;.on() only accepts instances of Function&#x27;);
    }
  
    &#x2F;&#x2F; Make an array for this particular eventName
    if(this.callbacks[eventType]===undefined){
      this.callbacks[eventType] = [];
    }
  
    &#x2F;&#x2F; TODO: Is there any cheap way to detect duplicates.
    this.callbacks[eventType].push(fn);  
  },

  &#x2F;**
  Alias for {EventEmitter.addEventListener}
  
  @method on
  **&#x2F;
  on:function(eventType,fn){
    this.addEventListener(eventType,fn);
  },

  &#x2F;**
  Unregister a callback for a particular event.
  
  @method removeEventListener
  @param {String} eventType Which event to stop listening to.
  @param {Function} fn Function to be removed.
  
  **&#x2F;
  
  removeEventListener: function(eventType,fn){
    &#x2F;&#x2F; Remove the callback from the list of listeners for the
    &#x2F;&#x2F; respective eventType
    if(this.callbacks[eventType]!==undefined){
      var i,callbacks = this.callbacks[eventType];
      for(var i = 0; i&lt;callbacks.length;i++){
        if(callbacks[i]==fn){
          callbacks.splice(i,1);
          return;
        }
      }
    }
  },
  
  &#x2F;**
  Alias for {EventEmitter.removeEventListener}
  
  @method off
  **&#x2F;
  off: function(eventType,fn){
    this.removeEventListener(eventType,fn);
  },
  
  &#x2F;**
  Trigger an event. (Calls all the callbacks that are listening for the eventType)
  
  @method trigger
  @param {String} eventType Which event to trigger.
  @param {Event} event Event that will be passed to all registered listeners.
  
  **&#x2F;
  trigger: function(eventType,event){
    if(this.callbacks[eventType]!==undefined){
      var i,callbacks = this.callbacks[eventType];
      for(var i = 0; i&lt;callbacks.length;i++){
        callbacks[i](event);
      }
    }
  }
});

&#x2F;**
The Brass Monkey SDK. This is a singleton accessed like so:

    bm.init(...);
    
or

    var version = bm.version;

@class bm
@extends bm.EventEmitter
@static
**&#x2F;

&#x2F;&#x2F; Create the BrassMonkey global object. (Give it a short alias of &#x27;bm&#x27; also)
&#x2F;&#x2F; TODO:  Make a function similar to jQuery.noConflict(). I&#x27;ve already had
&#x2F;&#x2F;        issues with collisions on a global bm. object when working with Game Maker
&#x2F;&#x2F;        generated game projects.

var BrassMonkeyClass = EventEmitter.extend({
  init:function(){
    this._super();
    &#x2F;**
    Version number of the SDK. 
    
    Format:
    
        Major.Minor.Patch
    
    Example:
    
        &quot;0.5.1&quot;
        
    Follows the [Semantic Versioning Specification.](http:&#x2F;&#x2F;semver.org)
    
    @property version 
    @type String
    **&#x2F;
    this.version = &quot;0.5.0&quot;;
    
    
    this.devices = {};
  },
 &#x2F;**
  Startup Brass Monkey
  
  @method start
  @param {Object} options Options 
    for initializing Brass Monkey.
    @param {String} options.name The name of your game. This is what 
      is displayed on the phone when you pick what to connect to.
      
      Example: &quot;Monkey Golf&quot;
    @param {String} options.appID The unique identifier of your Game&#x2F;App. You
      must generate this through the developer admin interface.
      
    @param {Number} [options.maxPlayers=1]
      The number of players that can play your game.
      
    @param {URL} [options.swfURL]
      The location of the SWF file that implements 
      the SDK when there a browser doesn&#x27;t support Websockets. 
      
      If not provided the matching version on the Brass Monkey CDN is used.
  **&#x2F;
  start: function(options){
    
    &#x2F;&#x2F; Store options for convenient access later
      &#x2F;&#x2F; TODO: Add defaults to these options for those not provided.
    this.options = options;  
      &#x2F;&#x2F; If no images&#x2F;layout were provided we default them to being empty arrays.
      &#x2F;&#x2F; This could be the case for when certain hosts like the website only
      &#x2F;&#x2F; use the built in controllers (Keyboard Mode, Navigation Mode, and any future
      &#x2F;&#x2F; ones) 
    &#x2F;&#x2F;bm.options.design.images =  options.design.images?options.design.images:[];
    &#x2F;&#x2F;bm.options.design.layout =  options.design.layout?options.design.layout:[];
    
    
    
    &#x2F;&#x2F; Choose the proper communication runtime based on the environment.
    &#x2F;&#x2F; For now it&#x27;s basically WebSockets in Mobile Safari otherwise Flash
    &#x2F;&#x2F; everywhere else.
    if(true){&#x2F;&#x2F;bm.detectIOS()){
      this.runtime = new bm.WebSocketsRT();
    } else {
      this.runtime = new bm.FlashRT();
    }
    
    this.runtime.start();
  },
  
  &#x2F;**
  Shutdown Brass Monkey
  
  @method stop
  **&#x2F;
  stop: function(){
    if(bm.runtime!==undefined){
      bm.runtime.stop();
    }
  },
  
  &#x2F;**
  Shutdown Brass Monkey. 
  
  This will close all open network connections and disconnect all controllers.
  
  @method stop
  **&#x2F;
  log: function(str){
    console.log(str);
  },
  
  addDevice: function(device){
    this.devices[device.id] = device;
    
    this.trigger(&#x27;deviceconnected&#x27;, {type: &#x27;deviceconnected&#x27;, device: device});
  },
  
  removeDevice: function(device){
    delete this.devices[device.id];
    
    this.trigger(&#x27;devicedisconnected&#x27;, {type: &#x27;devicedisconnected&#x27;, device: device});
  },
  
  getDevice: function(id){
    return this.devices[id];
  }
  
});

&#x2F;&#x2F; Create singleton instance of BrassMonkey
bm = BrassMonkey = new BrassMonkeyClass();

&#x2F;&#x2F; Add EventEmitter to the BrassMonkey namespace
bm.EventEmitter = EventEmitter;
bm.Class = Class;

&#x2F;&#x2F; Constants
&#x2F;*
bm.MODE_GAMEPAD=0;	
bm.MODE_KEYBOARD=1;		
bm.MODE_NAVIGATION=2;		
bm.MODE_WAIT=3;
*&#x2F;

&#x2F;*---------------------------------------------------------------------------------------
Enumerate Events here. I (Francois) tried to put these in events.js but couldn&#x27;t get 
yuidoc to properly associate with the BrassMonkey Class.
---------------------------------------------------------------------------------------*&#x2F;

&#x2F;**
Event called when a mobile device successfully established a connection.

@event deviceavailable
@param {String} type Which event this is. Ie. **&quot;deviceavailable&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;

&#x2F;**
Event called when a mobile device successfully established a connection.

@event deviceconnected
@param {String} type Which event this is. Ie. **&quot;deviceconnected&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;

&#x2F;**
Event called when a mobile device is disconnected.

@event devicedisconnected
@param {String} type Which event this is. Ie. **&quot;devicedisconnected&quot;**
@param {bm.Device} device Device that generated this event.

**&#x2F;

&#x2F;**
Event called when the SDK has received it&#x27;s assigned slot index&#x2F;color.

This is the unique color that is displayed in top right of the console, in your game, and 
on the device list in the controller app. It&#x27;s used to help users disambiguate which
console&#x2F;game they want to connect to, if there is more than one on their network.

@event showslotcolor
@param {String} type Which event this is. Ie. **&quot;showslotcolor&quot;**
@param {Number} slot Unique identifier to your network. (Each instance of Brass Monkey running get it&#x27;s own slot number assigned.)

@param {String} color Color to display on the screen. (CSS Style Hexidecimal)
    
    Example:
    
        &quot;#ff0000&quot;
             
**&#x2F;

&#x2F;&#x2F; Lookup table for converting slot index numbers into an agreed upon matching color.
bm.slotColors = [
  &quot;#ff6600&quot;,&quot;#ffcc00&quot;,&quot;#ff3399&quot;,&quot;#ff0066&quot;,
  &quot;#cc00ff&quot;,&quot;#999900&quot;,&quot;#9999cc&quot;,&quot;#00cc99&quot;,
  &quot;#287200&quot;,&quot;#00ccff&quot;,&quot;#003366&quot;,&quot;#99ff00&quot;,
  &quot;#cc0000&quot;,&quot;#80cd68&quot;,&quot;#6600ff&quot;
];

&#x2F;*    
this.slot = (Math.max(1, this.slot) - 1) % slotColors.length;
this.color = slotColors[this.slot];
*&#x2F;

&#x2F;**
Event representing the latest accelerometer values.

**Note:** 

  Accelerometer events must be enabled (See [Device.enableAccelerometer](bm.Device.html)) and are sent continuously on the interval specified by [Device.setAccelerometerInterval](bm.Device.html).

@event accelerometer
@param {String} type Which event this is. Ie. **&quot;accelerometer&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;

&#x2F;**
Event representing the latest gyroscope values.

**Note:** 

  Gyroscope events must be enabled (See [Device.enableGyroscope](bm.Device.html)) and are sent continuously on the interval specified by [Device.setGyroscopeInterval](bm.Device.html).

@event gyroscope
@param {String} type Which event this is. Ie. **&quot;gyroscope&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;

&#x2F;**
Event representing the latest orientation values.

**Note:** 

  Orientation events must be enabled (See [Device.enableOrientation](bm.Device.html)) and are sent continuously on the interval specified by [Device.setOrientationInterval](bm.Device.html).

@event orientation
@param {String} type Which event this is. Ie. **&quot;orientation&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;


&#x2F;**
Event called when a button was pressed down.

@event buttondown
@param {String} type Which event this is. Ie. **&quot;buttondown&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;

&#x2F;**
Event called when a button was released.

@event buttonup
@param {String} type Which event this is. Ie. **&quot;buttonup&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;

&#x2F;**
Event indicating the user shook their device.

**Note:** Accelerometer&#x2F;Gyroscope events do not need to enabled, shake events do not take much network traffic so this was unnecessary.

@event shake
@param {String} type Which event this is, Ie. **&quot;shake&quot;**
@param {bm.Device} device Device that generated this event.
**&#x2F;

})();
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
