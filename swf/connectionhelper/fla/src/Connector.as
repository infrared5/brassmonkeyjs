package{	import com.brassmonkey.events.DeviceEvent;	import flash.display.MovieClip;	import flash.events.Event;	import flash.utils.setInterval;	import flash.external.ExternalInterface;	import com.adobe.serialization.json.JSONDecoder;		import com.greensock.*;	import flash.events.MouseEvent;		public class Connector extends MovieClip	{		//private var scheme:TestDoctorScheme=new TestDoctorScheme();				//private var bm:BMApplication;		private var interation:int = 0;		private var error:Boolean=false;		private var conn:Boolean=false;				public function buttonOver(e:MouseEvent)		{			TweenMax.to(e.currentTarget, 0.3, {colorTransform:{brightness:1.2}});		}				public function buttonOut(e:MouseEvent)		{			TweenMax.to(e.currentTarget, 0.3, {colorTransform:{brightness:1}});		}				public function Connector()		{			super();						//Buttons			helpBtn.buttonMode = true;			helpBtn.addEventListener(MouseEvent.MOUSE_OVER, buttonOver);			helpBtn.addEventListener(MouseEvent.MOUSE_OUT, buttonOut);						download_ios.buttonMode = true;			download_ios.addEventListener(MouseEvent.MOUSE_OVER, buttonOver);			download_ios.addEventListener(MouseEvent.MOUSE_OUT, buttonOut);						download_android.buttonMode = true;			download_android.addEventListener(MouseEvent.MOUSE_OVER, buttonOver);			download_android.addEventListener(MouseEvent.MOUSE_OUT, buttonOut);						nodeviceBtn.buttonMode = true;			nodeviceBtn.addEventListener(MouseEvent.MOUSE_OVER, buttonOver);			nodeviceBtn.addEventListener(MouseEvent.MOUSE_OUT, buttonOut);						addEventListener(Event.INIT, boot);			steps.step1.alpha = 1;			steps.step2.alpha = 0.3;			steps.step3.alpha = 0.3;					}				public function boot(event:Event):void		{			steps.step2.alpha = 0.3;			steps.step3.alpha = 0.3;						nodeviceBtn.visible = false;			phone.visible = false;			_deviceList.visible = false;			//_timer.visible = false;						nodeviceBtn.visible = false;						loaderInfo.removeEventListener(Event.INIT, boot);			//	bm=new BMApplication(loaderInfo.parameters);			//	bm.client=this;						//	bm.initiate("Select Me",1);				//	bm.addEventListener(DeviceEvent.SLOT_DISPLAY_REQUEST, onSlot);			//	bm.addEventListener(DeviceEvent.DEVICE_AVAILABLE, onDevice);			//	bm.addEventListener(DeviceEvent.DEVICE_CONNECTED, onDevice);			//	bm.addEventListener(DeviceEvent.DEVICES_DISCOVERED, onDevice);				//	bm.addEventListener(DeviceEvent.DEVICE_DISCONNECTED , onDevice);			//	bm.start();			//if(ExternalInterface.available){				//ExternalInterface.addCallback("onTick",onTick);				//ExternalInterface.addCallback("setState",setState);				//ExternalInterface.addCallback("setSlot",setSlot);			//}						//Buttons					}		public function setState( val:String):void		{			trace(val);			var f:JSONDecoder=new JSONDecoder(val);			var messa:Object=f.getValue();			onDevice(messa);					}				public function onDevice(event:Object):void		{			trace(event.type);			switch(event.type)			{				case DeviceEvent.DEVICES_DISCOVERED:					while(this._deviceList.numChildren>1)					{						_deviceList.removeChildAt(1);					}					var clients:Array=[];										for each (var device:Object in event.devices){										var d2:DeviceRendererClip = new DeviceRendererClip();					d2._deviceName.text=device.deviceName;					_deviceList.addChild(d2);					clients.push(device.deviceName);				}										trace(clients);										if(!conn && !error && clients.length>0 && event.registry.devices.length==0)					{												steps.step1.alpha = 0.3;						steps.step2.alpha = 1;						steps.step3.alpha = 0.3;												nodeviceBtn.visible = true;						phone.visible = true;						_deviceList.visible = true;						_timer.visible = true;												helpBtn.visible = false;						quotes.visible = false;												nodeviceBtn.visible = true;												_info.y = 390;												download_ios.visible = false;						download_android.visible = false;												topimage.visible = false;												//this._info.text='Do you see you device listed in box below?\nIf so, go to your device and select the option in the list.' ;					}					else if(!conn &&!error && event.registry.devices.length==0)					{												steps.step1.alpha = 1;						steps.step2.alpha = 0.3;						steps.step3.alpha = 0.3;												nodeviceBtn.visible = false;						phone.visible = false;						_deviceList.visible = false;						//_timer.visible = false;												helpBtn.visible = true;						quotes.visible = true;												nodeviceBtn.visible = false;												_info.y = 470;												download_ios.visible = true;						download_android.visible = true;												topimage.visible = true;												//this._info.text='Download and start up the Brass Monkey application now. Make sure you device is on the same WiFi connection as your computer or smart tv.' ;					}					else					{											}					arrangeList();					//this.idDevices.dataProvider=new ArrayCollection(clients);					break;								case DeviceEvent.DEVICE_AVAILABLE:					if(event.registry.devices.length==0)					{						//this._info.text='Okay, Lets see if we can connect your device over your local lan.' ;						conn=true;						//event.device.addEventListener(DeviceEvent.CAN_NOT_CONNECT, onDevice);						//bm.session.connectDevice(event.device);											}					break;								case DeviceEvent.CAN_NOT_CONNECT:					trace("cant connect");					conn=false;					error=true;					//this._info.text='No! Unfortunalty, your LAN configuration is preventing the connection. Reconfigure your LAN and please try again.' ;					break;									case DeviceEvent.DEVICE_CONNECTED:					//event.device.removeEventListener(DeviceEvent.CAN_NOT_CONNECT, onDevice);					steps.step1.alpha = 0.3;					steps.step2.alpha = 0.3;					steps.step3.alpha = 1;					conn=false;					//this._info.text='Success! You are now ready to play games!' ;										break;				case DeviceEvent.DEVICE_DISCONNECTED :					steps.step1.alpha = 0.3;					steps.step2.alpha = 1.0;					steps.step3.alpha = 0.3	;							break;			}		}				private function arrangeList():void		{			var i:int = 1;						var h:int = this._deviceList.numChildren;						for(i=1;i<h;i++){				this._deviceList.getChildAt(i).x=12;				this._deviceList.getChildAt(i).y=(34 * (i-1))+2;			}					}				public function onTick(val:int):void		{			_timer.text="Re-checking for smart-devices in.. "+val;		}			}}